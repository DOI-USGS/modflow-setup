

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pleasant Lake Example &mdash; modflow-setup 0.post50+gc85745d documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configuration File Gallery" href="../config-file-gallery.html" />
    <link rel="prev" title="Examples" href="../examples.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> modflow-setup
          

          
          </a>

          
            
            
              <div class="version">
                0.post50+gc85745d
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../philosophy.html">     Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html"> Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html"> Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pleasant Lake Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Model-details">Model details</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../config-file-gallery.html"> Configuration File Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../structure.html"> Basic program structure and usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config-file.html"> The configuration file</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html"> Code reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html"> Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html"> Contributing to modflow-setup</a></li>
</ul>
<p class="caption"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html"> References cited</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">modflow-setup</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Pleasant Lake Example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/Pleasant_lake_lgr_example.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Pleasant-Lake-Example">
<h1>Pleasant Lake Example<a class="headerlink" href="#Pleasant-Lake-Example" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="https://aleaf.github.io/modflow-setup/config-file-gallery.html#pleasant-lake-test-case">View the configuration file(s)</a></p></li>
<li><p><a class="reference external" href="https://mybinder.org/v2/gh/aleaf/modflow-setup/develop?urlpath=lab/tree/examples">Run this example</a><strong>on</strong><a class="reference external" href="https://mybinder.org/">Binder</a></p></li>
</ul>
<div class="section" id="Model-details">
<h2>Model details<a class="headerlink" href="#Model-details" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>MODFLOW-6 model with local grid refinement (LGR)</p></li>
<li><p>LGR parent model is itself a Telescopic Mesh Refinment (TMR) inset from a MODFLOW-NWT model</p></li>
<li><p>Layer 1 in TMR parent model is subdivided evenly into two layers in LGR model (<code class="docutils literal notranslate"><span class="pre">botm:</span> <span class="pre">from_parent:</span> <span class="pre">0:</span> <span class="pre">-0.5</span></code>). Other layers mapped explicitly between TMR parent and LGR model.</p></li>
<li><p>starting heads from LGR parent model resampled from binary output from the TMR parent</p></li>
<li><p>rch, npf, sto, and wel input copied from parent model</p></li>
<li><p>SFR package constructed from an NHDPlus v2 dataset (path to NHDPlus files in the same structure as the <code class="docutils literal notranslate"><span class="pre">downloads</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">NHDPlus</span> <span class="pre">website</span></code>_)</p></li>
<li><p>head observations from csv files with different column names</p></li>
<li><p>LGR inset extent based on a buffer distance around a feature of interest</p></li>
<li><p>LGR inset dis, ic, npf, sto and rch packages copied from LGR parent</p></li>
<li><p>WEL package created from custom format</p></li>
<li><p>Lake package created from polygon features, bathymetry raster, stage-area-volume file and climate data from <code class="docutils literal notranslate"><span class="pre">PRISM</span></code>_.</p></li>
<li><p>Lake package observations set up automatically (output file for each lake)</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">flopy</span>
<span class="kn">import</span> <span class="nn">flopy.utils.binaryfile</span> <span class="k">as</span> <span class="nn">bf</span>
<span class="kn">from</span> <span class="nn">mfsetup</span> <span class="kn">import</span> <span class="n">MF6model</span>
<span class="kn">from</span> <span class="nn">mfsetup.discretization</span> <span class="kn">import</span> <span class="n">cellids_to_kij</span>
<span class="kn">from</span> <span class="nn">gisutils</span> <span class="kn">import</span> <span class="n">df2shp</span>
<span class="kn">import</span> <span class="nn">mfexport</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span> <span class="o">=</span> <span class="n">MF6model</span><span class="o">.</span><span class="n">setup_from_yaml</span><span class="p">(</span><span class="s1">&#39;pleasant_lgr_parent.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
loading configuration file pleasant_lgr_parent.yml...

Setting up plsnt_lgr_parent model from data in None


arguments to MFSimulation:
sim_name: pleasant_lgr
version: mf6
exe_name: mf6
sim_ws: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr

arguments to ModflowGwf:
modelname: plsnt_lgr_parent
version: mf6
simulation: sim_name = pleasant_lgr
sim_path = /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr
exe_name = mf6

###################
Package mfsim.nam
###################

package_name = mfsim.nam
filename = mfsim.nam
package_type = nam
model_or_simulation_package = simulation
simulation_name = pleasant_lgr



list: plsnt_lgr_parent.list
print_input: True
print_flows: False
save_flows: True
newtonoptions: [&#39;under_relaxation&#39;]
loading parent model /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant.nam...

arguments to Modflow.load:
model_ws: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant
version: mfnwt
load_only: [rch ... bas6]
f: pleasant.nam
finished in 0.12s


arguments to MFsetupGrid:
xoff: 552200.0
yoff: 387000.0
angrot: 0.0
epsg: 3070
delr: array: (36,), float32, min: 200, mean: 200, max: 200
delc: array: (34,), float32, min: 200, mean: 200, max: 200
top: array: (34, 36), float32, min: 283.24, mean: 319.565, max: 389.51
botm: array: (4, 34, 36), float32, min: 187.31, mean: 271.826, max: 388.41
lenuni: 2

arguments to setup_perioddata_group:
start_date_time: 2012-01-01
nper: 13
model_time_units: days
perlen: array: (13,), float32, min: 1, mean: 28.2308, max: 31
nstp: array: (13,), int32, min: 1, mean: 4.69231, max: 5
tsmult: array: (13,), float32, min: 1, mean: 1.46154, max: 1.5
steady: array: (13,), bool, min: 0, mean: 0.0769231, max: 1

arguments to setup_structured_grid:
rotation: 0.0
snap_to_NHG: False
xoff: 553000
yoff: 388000
nrow: 25
ncol: 25
dxy: 200
grid_file: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
epsg: 3070
nlay: 5
parent_model: MODFLOW 4 layer(s) 34 row(s) 36 column(s) 13 stress period(s)
model_length_units: meters
bbox_shapefile: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp
setting up model grid...

arguments to MFsetupGrid:
delr: [200.0 ... 200.0]
delc: [200.0 ... 200.0]
xoff: 553000
yoff: 388000
xul: 552800.0
yul: 393200.0
lenuni: 2
angrot: 0.0
epsg: 3070
top: None
botm: None
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp... Done
finished in 0.03s

loading configuration file /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr_inset.yml...

arguments to ModflowGwf:
modelname: plsnt_lgr_inset
version: mf6
simulation:
arguments to setup_perioddata_group:
start_date_time: 2012-01-01
nper: 1
steady: True
oc_saverecord: {0: [&#39;save head last&#39;, &#39;save budget last&#39;]}
nstp: 1
tsmult: 1

arguments to setup_perioddata_group:
start_date_time: 2012-01-01
nper: None
steady: False
oc_saverecord: {0: [&#39;save head last&#39;, &#39;save budget last&#39;]}
end_date_time: 2012-12-31
freq: 1MS
nstp: 1
tsmult: 1.5
sim_name = pleasant_lgr
sim_path = /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr
exe_name = mf6

###################
Package mfsim.nam
###################

package_name = mfsim.nam
filename = mfsim.nam
package_type = nam
model_or_simulation_package = simulation
simulation_name = pleasant_lgr


@@@@@@@@@@@@@@@@@@@@
Model plsnt_lgr_parent
@@@@@@@@@@@@@@@@@@@@

plsnt_lgr_parent model:
5 layer(s), 25 row(s), 25 column(s), 13 stress period(s)
Parent model: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant
CRS: epsg:3070
(epsg: 3070)
Bounds: (552800.0, 557800.0, 388200.0, 393200.0)
Grid spacing: 200.00 meters
Packages:

list: plsnt_lgr_inset.list
print_input: True
print_flows: False
save_flows: True
newtonoptions: [&#39;under_relaxation&#39;]

Setting up DIS package...

arguments to ArraySourceData:
length_units: meters
filenames: {0: &#39;/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/dem40m.tif&#39;}

arguments to ArraySourceData:
datatype: array2d
variable: top
dest_model: plsnt_lgr_parent model:
5 layer(s), 25 row(s), 25 column(s), 13 stress period(s)
Parent model: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant
CRS: epsg:3070
(epsg: 3070)
Bounds: (552800.0, 557800.0, 388200.0, 393200.0)
Grid spacing: 200.00 meters
Packages:
vmin: -1e+30
vmax: 1e+30
resample_method: linear
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/dem40m.tif...
finished in 0.06s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s

arguments to ArraySourceData:
filenames: {1: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm0.tif
 ...
}

arguments to ArraySourceData:
datatype: array3d
variable: botm
dest_model: plsnt_lgr_parent model:
5 layer(s), 25 row(s), 25 column(s), 13 stress period(s)
Parent model: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant
CRS: epsg:3070
(epsg: 3070)
Bounds: (552800.0, 557800.0, 388200.0, 393200.0)
Grid spacing: 200.00 meters
Packages:
vmin: -1e+30
vmax: 1e+30
resample_method: linear
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm0.tif...
finished in 0.05s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm1.tif...
finished in 0.04s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm2.tif...
finished in 0.04s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm3.tif...
finished in 0.04s
loading original/plsnt_lgr_parent_top.dat.original, shape=(25, 25), took 0.00s
computing cell thicknesses...
finished in 0.04s

wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm4.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain4.dat, took 0.00s

arguments to ModflowGwfdis:
nrow: 25
ncol: 25
nlay: 5
delr: [200.0 ... 200.0]
delc: [200.0 ... 200.0]
angrot: 0.0
top: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_top.dat&#39;}]
botm: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm4.dat&#39;}]
idomain: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain4.dat&#39;}]
xorigin: 553000
yorigin: 388000
length_units: meters
computing cell thicknesses...
finished in 0.04s

wrote original/plsnt_lgr_parent_lakarr0.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr1.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr2.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr3.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr4.dat, took 0.00s
loading original/plsnt_lgr_parent_top.dat.original, shape=(25, 25), took 0.00s
computing cell thicknesses...
finished in 0.02s

wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm4.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain4.dat, took 0.00s

arguments to setup_structured_grid:
rotation: 0.0
snap_to_NHG: False
xoff: 553000
yoff: 388000
nrow: 25
ncol: 25
dxy: 200
grid_file: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
epsg: 3070
nlay: 5
parent_model: MODFLOW 4 layer(s) 34 row(s) 36 column(s) 13 stress period(s)
model_length_units: meters
bbox_shapefile: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp
top: array: (25, 25), float64, min: 291.87, mean: 323.488, max: 369.5
botm: array: (5, 25, 25), float64, min: 189.36, mean: 282.613, max: 355.77
setting up model grid...

arguments to MFsetupGrid:
delr: [200.0 ... 200.0]
delc: [200.0 ... 200.0]
xoff: 553000
yoff: 388000
xul: 552800.0
yul: 393200.0
lenuni: 2
angrot: 0.0
epsg: 3070
top: array: (25, 25), float64, min: 291.87, mean: 323.488, max: 369.5
botm: array: (5, 25, 25), float64, min: 189.36, mean: 282.613, max: 355.77
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp... Done
finished in 0.02s

loading configuration file /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr_inset.yml...
wrote ./external/plsnt_lgr_parent_irch.dat, took 0.00s
finished in 0.46s


arguments to MFsetupGrid:
xoff: 552800.0
yoff: 388200.0
angrot: 0.0
epsg: 3070
delr: array: (25,), float64, min: 200, mean: 200, max: 200
delc: array: (25,), float64, min: 200, mean: 200, max: 200
top: array: (25, 25), float64, min: 291.87, mean: 323.488, max: 369.5
botm: array: (5, 25, 25), float64, min: 189.36, mean: 282.613, max: 355.77
lenuni: 2

arguments to setup_perioddata_group:
start_date_time: 2012-01-01
nper: 1
steady: True
oc_saverecord: {0: [&#39;save head last&#39;, &#39;save budget last&#39;]}
nstp: 1
tsmult: 1

arguments to setup_perioddata_group:
start_date_time: 2012-01-01
nper: None
steady: False
oc_saverecord: {0: [&#39;save head last&#39;, &#39;save budget last&#39;]}
end_date_time: 2012-12-31
freq: 1MS
nstp: 1
tsmult: 1.5

arguments to setup_structured_grid:
rotation: 0
snap_to_NHG: False
dxy: 40
buffer: 1000
grid_file: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
epsg: 3070
nlay: 5
id_column: HYDROID
include_ids: [600059060]
features_shapefile: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp
parent_model: plsnt_lgr_parent model:
5 layer(s), 25 row(s), 25 column(s), 13 stress period(s)
Parent model: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant
CRS: epsg:3070
(epsg: 3070)
Bounds: (552800.0, 557800.0, 388200.0, 393200.0)
Grid spacing: 200.00 meters
Packages: dis
model_length_units: meters
bbox_shapefile: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp
setting up model grid...

arguments to shp2df:
dest_crs: epsg:3070

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
filtering on bounding box 552800.0, 388200.0, 557800.0, 393200.0...
--&gt; building dataframe... (may take a while for large shapefiles)

arguments to MFsetupGrid:
delr: [40.0 ... 40.0]
delc: [40.0 ... 40.0]
xoff: None
yoff: None
xul: 554200.0
yul: 391800.0
lenuni: 2
angrot: 0.0
epsg: 3070
top: None
botm: None
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp... Done
finished in 0.26s

computing cell thicknesses...
finished in 0.02s

wrote original/plsnt_lgr_parent_lakarr0.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr1.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr2.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr3.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr4.dat, took 0.00s
loading original/plsnt_lgr_parent_top.dat.original, shape=(25, 25), took 0.00s
computing cell thicknesses...
finished in 0.02s

wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm4.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain4.dat, took 0.00s

arguments to setup_structured_grid:
rotation: 0.0
snap_to_NHG: False
xoff: 553000
yoff: 388000
nrow: 25
ncol: 25
dxy: 200
grid_file: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
epsg: 3070
nlay: 5
parent_model: MODFLOW 4 layer(s) 34 row(s) 36 column(s) 13 stress period(s)
model_length_units: meters
bbox_shapefile: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp
top: array: (25, 25), float64, min: -9999, mean: -3372.45, max: 369.5
botm: array: (5, 25, 25), float64, min: -9999, mean: -3399.95, max: 355.77
setting up model grid...

arguments to MFsetupGrid:
delr: [200.0 ... 200.0]
delc: [200.0 ... 200.0]
xoff: 553000
yoff: 388000
xul: 552800.0
yul: 393200.0
lenuni: 2
angrot: 0.0
epsg: 3070
top: array: (25, 25), float64, min: -9999, mean: -3372.45, max: 369.5
botm: array: (5, 25, 25), float64, min: -9999, mean: -3399.95, max: 355.77
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp... Done
finished in 0.02s

wrote ./external/plsnt_lgr_parent_irch.dat, took 0.00s

Setting up TDIS package...

arguments to ModflowTdis:
time_units: days
start_date_time: 2012-01-01
nper: 13
perioddata: array: (13,), (numpy.record, [(&#39;perlen&#39;, &#39;&lt;f8&#39;), (&#39;nstp&#39;, &#39;&lt;i8&#39;), (&#39;tsmult&#39;, &#39;&lt;f8&#39;)])
finished in 0.00s


Setting up IMS package...

arguments to ModflowIms:
print_option: all
complexity: moderate
outer_hclose: 0.01
outer_rclosebnd: 1.e4
outer_maximum: 200
under_relaxation: dbd
under_relaxation_theta: 0.7
under_relaxation_kappa: 0.1
under_relaxation_gamma: 0.0
under_relaxation_momentum: 0.0
backtracking_number: 0
inner_maximum: 100
inner_hclose: 0.0001
rcloserecord: [0.0001, &#39;relative_rclose&#39;]
linear_acceleration: bicgstab
scaling_method: None
reordering_method: None
relaxation_factor: 0.0
number_orthogonalizations: 0
preconditioner_levels: 7
preconditioner_drop_tolerance: 0.001
finished in 0.00s


Setting up IC package...
getting i, j locations...
finished in 0.00s

wrote ./external/plsnt_lgr_parent_strt0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_strt1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_strt2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_strt3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_strt4.dat, took 0.00s

arguments to ModflowGwfic:
strt: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_strt0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_strt4.dat&#39;}]
finished in 0.14s


Setting up NPF package...
wrote ./external/plsnt_lgr_parent_k0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k4.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k330.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k331.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k332.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k333.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k334.dat, took 0.00s

arguments to ModflowGwfnpf:
save_flows: True
icelltype: 1
k: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_k0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_k4.dat&#39;}]
k33: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_k330.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_k334.dat&#39;}]
finished in 0.28s


Setting up STO package...
wrote ./external/plsnt_lgr_parent_sy0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_sy1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_sy2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_sy3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_sy4.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss4.dat, took 0.00s

arguments to ModflowGwfsto:
save_flows: True
iconvert: 1
sy: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_sy0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_sy4.dat&#39;}]
ss: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_ss0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_ss4.dat&#39;}]
steady_state: {0: True
 ...
}
transient: {0: False
 ...
}
finished in 0.29s


Setting up RCH package...
wrote ./external/plsnt_lgr_parent_irch.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch4.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch5.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch6.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch7.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch8.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch9.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch10.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch11.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch12.dat, took 0.00s

arguments to ModflowGwfrcha:
irch: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_irch.dat&#39;}]
recharge: {0: {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_rch0.dat&#39;}
 ...
}
print_input: True
print_flows: True
save_flows: True
readasarrays: True
finished in 0.07s


Setting up OC package...

arguments to ModflowGwfoc:
budget_filerecord: plsnt_lgr_parent.cbc
head_filerecord: plsnt_lgr_parent.hds
saverecord: defaultdict(&lt;class &#39;list&#39;&gt;, {0: [(&#39;head&#39;, &#39;last&#39;), (&#39;budget&#39;, &#39;last&#39;)]})
finished in 0.00s


Setting up SFR package...

loading NHDPlus v2 hydrography data...
for basins:
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/NHDSnapshot/Hydrography/NHDFlowline.shp...
filtering on bounding box -89.5911225596923, 43.965959882234365, -89.52843935935044, 44.01121639579922...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/PlusFlowlineVAA.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/PlusFlow.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/elevslope.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

load finished in 0.08s

Getting routing information from NHDPlus Plusflow table...
finished in 0.01s


arguments to Lines.to_sfr:

SFRmaker version 0.6.0.post5+g78c82fe

Creating sfr dataset...

Creating grid class instance from flopy Grid instance...
grid class created in 0.05s

Model grid information
structured grid
nnodes: 625
nlay: 1
nrow: 25
ncol: 25
model length units: undefined
crs: EPSG:3070
bounds: 552800.00, 388200.00, 557800.00, 393200.00
active area defined by: isfr array

plsnt_lgr_parent model:
5 layer(s), 25 row(s), 25 column(s), 13 stress period(s)
Parent model: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant
CRS: epsg:3070
(epsg: 3070)
Bounds: (552800.0, 557800.0, 388200.0, 393200.0)
Grid spacing: 200.00 meters
Packages: dis ic npf sto rcha oc
Warning: No length units specified in CRS for input LineStrings or length units not recognizeddefaulting to meters.

reprojecting hydrography from
EPSG:4269
to
EPSG:3070


Culling hydrography to active area...
simplification tolerance: 2000.00
starting lines: 2
remaining lines: 2
finished in 0.00s


Intersecting 2 flowlines with 625 grid cells...
Intersecting 2 features...
2
finished in 0.01s

Setting up reach data... (may take a few minutes for large grids)
finished in 0.00s

Computing widths...

Dropping 0 reaches with length &lt; 10.00 meters...

Repairing routing connections...
enforcing best segment numbering...

Setting up segment data...
Model grid information
structured grid
nnodes: 625
nlay: 1
nrow: 25
ncol: 25
model length units: undefined
crs: EPSG:3070
bounds: 552800.00, 388200.00, 557800.00, 393200.00
active area defined by: isfr array


Time to create sfr dataset: 0.17s

running rasterstats.zonal_stats on buffered LineStrings...
finished in 0.02s


Smoothing elevations...
finished in 0.00s

arguments to SFRData.add_observations:
obstype: downstream-flow
x_location_column: x
y_location_column: y
obsname_column: site_no
data: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/gages.csv
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/tables/plsnt_lgr_parent_sfr_reach_data.csv
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/tables/plsnt_lgr_parent_sfr_segment_data.csv
converting segment data to period data...
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_cells.shp... Done
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_outlets.shp... Done
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_lines.shp... Done
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_routing.shp... Done
No period data to export!
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_observations.shp... Done
No non-zero values of flow to export!

arguments to ModflowGwfsfr:
save_flows: True
mover: True
converting reach and segment data to package data...
converting segment data to period data...
computing cell thicknesses...
finished in 0.02s

wrote original/plsnt_lgr_parent_lakarr0.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr1.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr2.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr3.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr4.dat, took 0.00s
loading original/plsnt_lgr_parent_top.dat.original, shape=(25, 25), took 0.00s
computing cell thicknesses...
finished in 0.02s

wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm4.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain0.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain1.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain2.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain3.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain4.dat, took 0.00s

arguments to setup_structured_grid:
rotation: 0.0
snap_to_NHG: False
xoff: 553000
yoff: 388000
nrow: 25
ncol: 25
dxy: 200
grid_file: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
epsg: 3070
nlay: 5
parent_model: MODFLOW 4 layer(s) 34 row(s) 36 column(s) 13 stress period(s)
model_length_units: meters
bbox_shapefile: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp
top: array: (25, 25), float64, min: -9999, mean: -3372.45, max: 369.5
botm: array: (5, 25, 25), float64, min: -9999, mean: -3399.93, max: 355.77
setting up model grid...

arguments to MFsetupGrid:
delr: [200.0 ... 200.0]
delc: [200.0 ... 200.0]
xoff: 553000
yoff: 388000
xul: 552800.0
yul: 393200.0
lenuni: 2
angrot: 0.0
epsg: 3070
top: array: (25, 25), float64, min: -9999, mean: -3372.45, max: 369.5
botm: array: (5, 25, 25), float64, min: -9999, mean: -3399.93, max: 355.77
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp... Done
finished in 0.02s

wrote ./external/plsnt_lgr_parent_irch.dat, took 0.00s
finished in 0.72s


Setting up LAK package...
wrote original/plsnt_lgr_parent_lakarr0.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr1.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr2.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr3.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr4.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr0.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr1.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr2.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr3.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr4.dat, took 0.00s
lakes_shapefile not specified, or no lakes in model area

Setting up WEL package...
getting i, j locations...
finished in 0.00s


arguments to ModflowGwfwel:
stress_period_data: {0: {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_wel_000.dat&#39;}
 ...
}
print_input: True
print_flows: True
save_flows: True
boundnames: True
finished in 0.11s


Setting up OBS package...
Reading observation files...
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/nwis_heads_info_file.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/lake_sites.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/wdnr_gw_sites.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/uwsp_heads.csv
    observation type col: obs_type
    observation label column: obsnme
    observation label column: obsnme
    x location col: x
    y location col: y
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/wgnhs_head_targets.csv
    observation type col: obs_type
    observation label column: common_name
    observation label column: common_name
    x location col: x
    y location col: y

Culling observations to model area...
Dropping head observations that coincide with Lake Package Lakes...
getting i, j locations...
finished in 0.00s

Dropping head observations specified in /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr_parent.yml...

arguments to ModflowUtlobs:
digits: 10
print_input: True
continuous: {&#39;plsnt_lgr_parent.head.obs&#39;: rec.array([(&#39;10051240_lk&#39;, &#39;HEAD&#39;, (1, 22, 20)), ...,
           (&#39;ys864&#39;, &#39;HEAD&#39;, (4, 5, 3))],
          dtype=[(&#39;obsname&#39;, &#39;O&#39;), (&#39;obstype&#39;, &#39;O&#39;), (&#39;id&#39;, &#39;O&#39;)])}
finished in 0.05s

setting up specified head perimeter boundary with CHD package...

arguments to MFsetupGrid:
xoff: 552200.0
yoff: 387000.0
angrot: 0.0
epsg: 3070
delr: array: (36,), float32, min: 200, mean: 200, max: 200
delc: array: (34,), float32, min: 200, mean: 200, max: 200
top: array: (34, 36), float32, min: 283.24, mean: 319.565, max: 389.51
botm: array: (4, 34, 36), float32, min: 187.31, mean: 271.826, max: 388.41
lenuni: 2

arguments to ModflowGwfchd:
stress_period_data: {0: {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_chd_000.dat&#39;}
 ...
}
print_input: False
print_flows: False
save_flows: True
finished in 1.85s


Setting up DIS package...

arguments to ArraySourceData:
length_units: meters
filenames: {0: &#39;/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/dem40m.tif&#39;}

arguments to ArraySourceData:
datatype: array2d
variable: top
dest_model: plsnt_lgr_inset model:
5 layer(s), 70 row(s), 80 column(s), 13 stress period(s)
Parent model: ./plsnt_lgr_parent
CRS: epsg:3070
(epsg: 3070)
Bounds: (554200.0, 557400.0, 389000.0, 391800.0)
Grid spacing: 40.00 meters
Packages:
vmin: -1e+30
vmax: 1e+30
resample_method: linear
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/dem40m.tif...
finished in 0.06s
wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s

arguments to ArraySourceData:
filenames: {1: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm0.tif
 ...
}

arguments to ArraySourceData:
datatype: array3d
variable: botm
dest_model: plsnt_lgr_inset model:
5 layer(s), 70 row(s), 80 column(s), 13 stress period(s)
Parent model: ./plsnt_lgr_parent
CRS: epsg:3070
(epsg: 3070)
Bounds: (554200.0, 557400.0, 389000.0, 391800.0)
Grid spacing: 40.00 meters
Packages:
vmin: -1e+30
vmax: 1e+30
resample_method: linear
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm0.tif...
finished in 0.04s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm1.tif...
finished in 0.05s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm2.tif...
finished in 0.04s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm3.tif...
finished in 0.04s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s

arguments to shp2df:
dest_crs: EPSG:3070

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
filtering on bounding box 554200.0, 389000.0, 557400.0, 391800.0...
--&gt; building dataframe... (may take a while for large shapefiles)
caching data in /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s
loading original/plsnt_lgr_inset_top.dat.original, shape=(70, 80), took 0.00s
computing cell thicknesses...
finished in 0.32s

wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm0.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm1.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm2.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm3.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm4.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain0.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain1.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain2.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain3.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain4.dat, took 0.00s

arguments to ModflowGwfdis:
nrow: 70
ncol: 80
nlay: 5
delr: [40.0 ... 40.0]
delc: [40.0 ... 40.0]
angrot: 0.0
top: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_top.dat&#39;}]
botm: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_botm0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_botm4.dat&#39;}]
idomain: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_idomain0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_idomain4.dat&#39;}]
xorigin: None
yorigin: None
length_units: meters
computing cell thicknesses...
finished in 0.19s

reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s
wrote original/plsnt_lgr_inset_lakarr0.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr1.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr2.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr3.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr4.dat, took 0.00s
loading original/plsnt_lgr_inset_top.dat.original, shape=(70, 80), took 0.00s
computing cell thicknesses...
finished in 0.15s

wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm0.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm1.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm2.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm3.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm4.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain0.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain1.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain2.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain3.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain4.dat, took 0.00s

arguments to setup_structured_grid:
rotation: 0
snap_to_NHG: False
dxy: 40
buffer: 1000
grid_file: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
epsg: 3070
nlay: 5
id_column: HYDROID
include_ids: [600059060]
features_shapefile: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp
parent_model: plsnt_lgr_parent model:
5 layer(s), 25 row(s), 25 column(s), 13 stress period(s)
Parent model: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant
CRS: epsg:3070
(epsg: 3070)
Bounds: (552800.0, 557800.0, 388200.0, 393200.0)
Grid spacing: 200.00 meters
Packages: dis ic npf sto rcha oc sfr_0 wel_0 obs_0 chd_0
model_length_units: meters
bbox_shapefile: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp
top: array: (70, 80), float64, min: 290.66, mean: 313.077, max: 348.61
botm: array: (5, 70, 80), float64, min: 191.27, mean: 276.082, max: 338.82
setting up model grid...

arguments to shp2df:
dest_crs: epsg:3070

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
filtering on bounding box 552800.0, 388200.0, 557800.0, 393200.0...
--&gt; building dataframe... (may take a while for large shapefiles)

arguments to MFsetupGrid:
delr: [40.0 ... 40.0]
delc: [40.0 ... 40.0]
xoff: None
yoff: None
xul: 554200.0
yul: 391800.0
lenuni: 2
angrot: 0.0
epsg: 3070
top: array: (70, 80), float64, min: 290.66, mean: 313.077, max: 348.61
botm: array: (5, 70, 80), float64, min: 191.27, mean: 276.082, max: 338.82
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp... Done
finished in 0.26s

wrote ./external/plsnt_lgr_inset_irch.dat, took 0.00s
finished in 2.52s


Setting up IC package...
getting i, j locations...
finished in 0.00s

wrote ./external/plsnt_lgr_inset_strt0.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_strt1.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_strt2.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_strt3.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_strt4.dat, took 0.00s

arguments to ModflowGwfic:
strt: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_strt0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_strt4.dat&#39;}]
finished in 0.10s


Setting up NPF package...
wrote ./external/plsnt_lgr_inset_k0.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_k1.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_k2.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_k3.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_k4.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_k330.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_k331.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_k332.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_k333.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_k334.dat, took 0.01s

arguments to ModflowGwfnpf:
save_flows: True
icelltype: 1
k: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_k0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_k4.dat&#39;}]
k33: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_k330.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_k334.dat&#39;}]
finished in 0.24s


arguments to setup_perioddata_group:
start_date_time: 2012-01-01
nper: 1
steady: True
oc_saverecord: {0: [&#39;save head last&#39;, &#39;save budget last&#39;]}
nstp: 1
tsmult: 1

arguments to setup_perioddata_group:
start_date_time: 2012-01-01
nper: None
steady: False
oc_saverecord: {0: [&#39;save head last&#39;, &#39;save budget last&#39;]}
end_date_time: 2012-12-31
freq: 1MS
nstp: 1
tsmult: 1.5

Setting up STO package...
wrote ./external/plsnt_lgr_inset_sy0.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_sy1.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_sy2.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_sy3.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_sy4.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_ss0.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_ss1.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_ss2.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_ss3.dat, took 0.01s
wrote ./external/plsnt_lgr_inset_ss4.dat, took 0.01s

arguments to ModflowGwfsto:
save_flows: True
iconvert: 1
sy: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_sy0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_sy4.dat&#39;}]
ss: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_ss0.dat&#39;} ... {&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_ss4.dat&#39;}]
steady_state: {0: True
 ...
}
transient: {0: False
 ...
}
finished in 0.24s


Setting up RCH package...
wrote ./external/plsnt_lgr_inset_irch.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch0.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch1.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch2.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch3.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch4.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch5.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch6.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch7.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch8.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch9.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch10.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch11.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch12.dat, took 0.00s

arguments to ModflowGwfrcha:
irch: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_irch.dat&#39;}]
recharge: {0: {&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_rch0.dat&#39;}
 ...
}
print_input: True
print_flows: True
save_flows: True
readasarrays: True
finished in 0.14s


Setting up OC package...

arguments to ModflowGwfoc:
budget_filerecord: plsnt_lgr_inset.cbc
head_filerecord: plsnt_lgr_inset.hds
saverecord: defaultdict(&lt;class &#39;list&#39;&gt;, {0: [(&#39;head&#39;, &#39;last&#39;), (&#39;budget&#39;, &#39;last&#39;)]})
finished in 0.00s


Setting up SFR package...

loading NHDPlus v2 hydrography data...
for basins:
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/NHDSnapshot/Hydrography/NHDFlowline.shp...
filtering on bounding box -89.57361941749177, 43.97318294263003, -89.53352803700078, 43.99854796302356...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/PlusFlowlineVAA.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/PlusFlow.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/elevslope.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

load finished in 0.07s

Getting routing information from NHDPlus Plusflow table...
finished in 0.01s

reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s

arguments to Lines.to_sfr:

SFRmaker version 0.6.0.post5+g78c82fe

Creating sfr dataset...

Creating grid class instance from flopy Grid instance...
grid class created in 0.15s

Model grid information
structured grid
nnodes: 5,600
nlay: 1
nrow: 70
ncol: 80
model length units: undefined
crs: EPSG:3070
bounds: 554200.00, 389000.00, 557400.00, 391800.00
active area defined by: isfr array

plsnt_lgr_inset model:
5 layer(s), 70 row(s), 80 column(s), 13 stress period(s)
Parent model: ./plsnt_lgr_parent
CRS: epsg:3070
(epsg: 3070)
Bounds: (554200.0, 557400.0, 389000.0, 391800.0)
Grid spacing: 40.00 meters
Packages: dis ic npf sto rcha oc
Warning: No length units specified in CRS for input LineStrings or length units not recognizeddefaulting to meters.

reprojecting hydrography from
EPSG:4269
to
EPSG:3070


Culling hydrography to active area...
simplification tolerance: 2000.00
starting lines: 2
remaining lines: 2
finished in 0.00s


Intersecting 2 flowlines with 5,600 grid cells...
Intersecting 2 features...
2
finished in 0.02s

Setting up reach data... (may take a few minutes for large grids)
finished in 0.01s

Computing widths...

Dropping 1 reaches with length &lt; 2.00 meters...

Repairing routing connections...
enforcing best segment numbering...

Setting up segment data...
Model grid information
structured grid
nnodes: 5,600
nlay: 1
nrow: 70
ncol: 80
model length units: undefined
crs: EPSG:3070
bounds: 554200.00, 389000.00, 557400.00, 391800.00
active area defined by: isfr array


Time to create sfr dataset: 0.30s

running rasterstats.zonal_stats on buffered LineStrings...
finished in 0.04s


Smoothing elevations...
finished in 0.00s
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/tables/plsnt_lgr_inset_sfr_reach_data.csv
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/tables/plsnt_lgr_inset_sfr_segment_data.csv
converting segment data to period data...
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_sfr_cells.shp... Done
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_sfr_outlets.shp... Done
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_sfr_lines.shp... Done
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_sfr_routing.shp... Done
No period data to export!
No observations to export!
No non-zero values of flow to export!

arguments to ModflowGwfsfr:
save_flows: True
mover: True
converting reach and segment data to package data...
converting segment data to period data...
computing cell thicknesses...
finished in 0.15s

reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s
wrote original/plsnt_lgr_inset_lakarr0.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr1.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr2.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr3.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr4.dat, took 0.00s
loading original/plsnt_lgr_inset_top.dat.original, shape=(70, 80), took 0.00s
computing cell thicknesses...
finished in 0.15s

wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm0.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm1.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm2.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm3.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm4.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain0.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain1.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain2.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain3.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain4.dat, took 0.00s

arguments to setup_structured_grid:
rotation: 0
snap_to_NHG: False
dxy: 40
buffer: 1000
grid_file: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
epsg: 3070
nlay: 5
id_column: HYDROID
include_ids: [600059060]
features_shapefile: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp
parent_model: plsnt_lgr_parent model:
5 layer(s), 25 row(s), 25 column(s), 13 stress period(s)
Parent model: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant
CRS: epsg:3070
(epsg: 3070)
Bounds: (552800.0, 557800.0, 388200.0, 393200.0)
Grid spacing: 200.00 meters
Packages: dis ic npf sto rcha oc sfr_0 wel_0 obs_0 chd_0
model_length_units: meters
bbox_shapefile: /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp
top: array: (70, 80), float64, min: 290.66, mean: 313.077, max: 348.61
botm: array: (5, 70, 80), float64, min: 191.27, mean: 276.082, max: 338.82
setting up model grid...

arguments to shp2df:
dest_crs: epsg:3070

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
filtering on bounding box 552800.0, 388200.0, 557800.0, 393200.0...
--&gt; building dataframe... (may take a while for large shapefiles)

arguments to MFsetupGrid:
delr: [40.0 ... 40.0]
delc: [40.0 ... 40.0]
xoff: None
yoff: None
xul: 554200.0
yul: 391800.0
lenuni: 2
angrot: 0.0
epsg: 3070
top: array: (70, 80), float64, min: 290.66, mean: 313.077, max: 348.61
botm: array: (5, 70, 80), float64, min: 191.27, mean: 276.082, max: 338.82
wrote /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
writing /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp... Done
finished in 0.26s

wrote ./external/plsnt_lgr_inset_irch.dat, took 0.00s
finished in 2.26s


Setting up LAK package...
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s
reading data from /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.19s
wrote original/plsnt_lgr_inset_lakarr0.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr1.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr2.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr3.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr4.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr0.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr1.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr2.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr3.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr4.dat, took 0.00s
setting up lakebed leakance zones...
finished in 0.01s
wrote original/plsnt_lgr_inset_lakzones.dat, took 0.00s
setting up tabfiles...

arguments to TabularSourceData:
length_units: meters
id_column: hydroid
column_mappings: {&#39;volume_m3&#39;: &#39;volume&#39;}
filenames: {0: &#39;/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/area_stage_vol_Pleasant.csv&#39;}

arguments to TabularSourceData:
wrote ./external/600059060_stage_area_volume.dat

arguments to PrismSourceData:
filenames: {600059060: &#39;/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/PRISM_ppt_tmean_stable_4km_189501_201901_43.9850_-89.5522.csv&#39;}
period_stats: {0: [&#39;mean&#39;, &#39;2012-01-01&#39;, &#39;2018-12-31&#39;]
 ...
}

arguments to PrismSourceData:
dest_model: plsnt_lgr_inset model:
5 layer(s), 70 row(s), 80 column(s), 13 stress period(s)
Parent model: ./plsnt_lgr_parent
CRS: epsg:3070
(epsg: 3070)
Bounds: (554200.0, 557400.0, 389000.0, 391800.0)
Grid spacing: 40.00 meters
Packages: dis ic npf sto rcha oc sfr_0

arguments to ModflowGwflak:
connectiondata: [[0, 0, (1, 36, 53), &#39;vertical&#39;, 0.025, 0.0, 0.0, 0.0, 0.0] ... [0, 465, (1, 43, 48), &#39;horizontal&#39;, 0.025, 290.17, 291.62, 40.0, 40.0]]
save_flows: True
boundnames: True
surfdep: 0.1
time_conversion: 86400.0
length_conversion: 1.0
nlakes: 1
noutlets: 0
packagedata: [[0, 290.85, 466, &#39;lake1&#39;]]
ntables: 1
tables: [(0, &#39;./external/600059060_stage_area_volume.dat&#39;, &#39;junk&#39;, &#39;junk&#39;)]
outlets: None
perioddata: {0: [[0, &#39;rainfall&#39;, 0.0026829936043197404], [0, &#39;withdrawal&#39;, 0.0], [0, &#39;evaporation&#39;, 0.0006298262025336206], [0, &#39;runoff&#39;, 0.0]]
 ...
}
observations: {lake1.obs.csv: [(&#39;stage&#39;, &#39;stage&#39;, &#39;lake1&#39;), (&#39;inflow&#39;, &#39;inflow&#39;, &#39;lake1&#39;), (&#39;rainfall&#39;, &#39;rainfall&#39;, &#39;lake1&#39;), (&#39;runoff&#39;, &#39;runoff&#39;, &#39;lake1&#39;), (&#39;lak&#39;, &#39;lak&#39;, &#39;lake1&#39;), (&#39;withdrawal&#39;, &#39;withdrawal&#39;, &#39;lake1&#39;), (&#39;evaporation&#39;, &#39;evaporation&#39;, &#39;lake1&#39;), (&#39;storage&#39;, &#39;storage&#39;, &#39;lake1&#39;), (&#39;volume&#39;, &#39;volume&#39;, &#39;lake1&#39;), (&#39;surface-area&#39;, &#39;surface-area&#39;, &#39;lake1&#39;), (&#39;wetted-area&#39;, &#39;wetted-area&#39;, &#39;lake1&#39;), (&#39;conductance&#39;, &#39;conductance&#39;, &#39;lake1&#39;)]
 ...
}
finished in 0.70s


Setting up WEL package...

arguments to shp2df:
dest_crs: EPSG:3070

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/csls_sources_wu_pts.shp...
--&gt; building dataframe... (may take a while for large shapefiles)
intersecting wells with model grid...
getting i, j locations...
finished in 0.00s

took 0.00s

computing cell thicknesses...
finished in 0.18s


arguments to shp2df:
dest_crs: EPSG:3070

reading /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/shps/csls_sources_wu_pts.shp...
--&gt; building dataframe... (may take a while for large shapefiles)
intersecting wells with model grid...
getting i, j locations...
finished in 0.00s

took 0.00s

computing cell thicknesses...
finished in 0.18s


Resampling pumping rates in /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/master_wu.csv to model stress periods...
    wells with no data for a stress period will be assigned 0.0 pumping rates.
took 0.01s


arguments to ModflowGwfwel:
stress_period_data: {0: {&#39;filename&#39;: &#39;./external/plsnt_lgr_inset_wel_000.dat&#39;}
 ...
}
print_input: True
print_flows: True
save_flows: True
boundnames: True
finished in 0.59s


Setting up OBS package...
Reading observation files...
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/nwis_heads_info_file.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/lake_sites.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/wdnr_gw_sites.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/uwsp_heads.csv
    observation type col: obs_type
    observation label column: obsnme
    observation label column: obsnme
    x location col: x
    y location col: y
/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/tables/wgnhs_head_targets.csv
    observation type col: obs_type
    observation label column: common_name
    observation label column: common_name
    x location col: x
    y location col: y

Culling observations to model area...
Dropping head observations that coincide with Lake Package Lakes...
getting i, j locations...
finished in 0.00s

Dropping head observations specified in /home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr_inset.yml...

arguments to ModflowUtlobs:
digits: 10
print_input: True
continuous: {&#39;plsnt_lgr_inset.head.obs&#39;: rec.array([(&#39;00400037_uwsp&#39;, &#39;HEAD&#39;, (0, 5, 6)), ...,
           (&#39;yq987&#39;, &#39;HEAD&#39;, (4, 28, 41))],
          dtype=[(&#39;obsname&#39;, &#39;O&#39;), (&#39;obstype&#39;, &#39;O&#39;), (&#39;id&#39;, &#39;O&#39;)])}
finished in 0.05s


Setting up the simulation water mover package...

arguments to ModflowGwfmvr:
print_flows: True
modelnames: True
maxmvr: 2
maxpackages: 2
packages: [(&#39;plsnt_lgr_parent&#39;, &#39;sfr_0&#39;), (&#39;plsnt_lgr_inset&#39;, &#39;sfr_0&#39;)]
perioddata: {0: [[&#39;plsnt_lgr_inset&#39;, &#39;sfr_0&#39;, 22, &#39;plsnt_lgr_parent&#39;, &#39;sfr_0&#39;, 7, &#39;factor&#39;, 1.0], [&#39;plsnt_lgr_inset&#39;, &#39;sfr_0&#39;, 24, &#39;plsnt_lgr_parent&#39;, &#39;sfr_0&#39;, 0, &#39;factor&#39;, 1.0]]}
finished in 0.01s


arguments to ModflowGwfgwf:
exgtype: gwf6-gwf6
exgmnamea: plsnt_lgr_parent
exgmnameb: plsnt_lgr_inset
nexg: 1378
auxiliary: [(&#39;angldegx&#39;, &#39;cdist&#39;)]
exchangedata: [[(0, 7, 6), (0, 0, 0), 1, 100.0, 20.0, 40.0, 0.0, 144.22205101855957] ... [(4, 21, 22), (4, 69, 79), 1, 100.0, 20.0, 40.0, 90.0, 144.22205101855957]]
mvr_filerecord: pleasant_lgr.mvr
finished setting up model in 12.13s

plsnt_lgr_parent model:
5 layer(s), 25 row(s), 25 column(s), 13 stress period(s)
Parent model: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant
CRS: epsg:3070
(epsg: 3070)
Bounds: (552800.0, 557800.0, 388200.0, 393200.0)
Grid spacing: 200.00 meters
Packages: dis ic npf sto rcha oc sfr_0 wel_0 obs_0 chd_0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
plsnt_lgr_parent model:
5 layer(s), 25 row(s), 25 column(s), 13 stress period(s)
Parent model: /home/travis/build/aleaf/modflow-setup/examples/data/pleasant/pleasant
CRS: epsg:3070
(epsg: 3070)
Bounds: (552800.0, 557800.0, 388200.0, 393200.0)
Grid spacing: 200.00 meters
Packages: dis ic npf sto rcha oc sfr_0 wel_0 obs_0 chd_0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;start_version&#39;, &#39;simulation&#39;, &#39;model&#39;, &#39;parent&#39;, &#39;intermediate_data&#39;, &#39;postprocessing&#39;, &#39;setup_grid&#39;, &#39;dis&#39;, &#39;tdis&#39;, &#39;ic&#39;, &#39;npf&#39;, &#39;sto&#39;, &#39;rch&#39;, &#39;sfr&#39;, &#39;high_k_lakes&#39;, &#39;lak&#39;, &#39;mvr&#39;, &#39;riv&#39;, &#39;wel&#39;, &#39;chd&#39;, &#39;oc&#39;, &#39;obs&#39;, &#39;ims&#39;, &#39;filename&#39;, &#39;ghb&#39;, &#39;maw&#39;, &#39;external_files&#39;, &#39;grid&#39;, &#39;perimeter_boundary&#39;])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;dis&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
defaultdict(dict,
            {&#39;options&#39;: {&#39;length_units&#39;: &#39;meters&#39;},
             &#39;dimensions&#39;: {&#39;nlay&#39;: 5},
             &#39;griddata&#39;: {&#39;top&#39;: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_top.dat&#39;}],
              &#39;botm&#39;: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm0.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm1.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm2.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm3.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm4.dat&#39;}],
              &#39;idomain&#39;: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain0.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain1.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain2.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain3.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain4.dat&#39;}]},
             &#39;top_filename_fmt&#39;: &#39;top.dat&#39;,
             &#39;botm_filename_fmt&#39;: &#39;botm{:d}.dat&#39;,
             &#39;idomain_filename_fmt&#39;: &#39;idomain{:d}.dat&#39;,
             &#39;minimum_layer_thickness&#39;: 1,
             &#39;drop_thin_cells&#39;: True,
             &#39;remake_top&#39;: True,
             &#39;source_data&#39;: {&#39;top&#39;: {&#39;filename&#39;: &#39;/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/dem40m.tif&#39;,
               &#39;elevation_units&#39;: &#39;meters&#39;},
              &#39;botm&#39;: {&#39;filenames&#39;: {1: &#39;/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm0.tif&#39;,
                2: &#39;/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm1.tif&#39;,
                3: &#39;/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm2.tif&#39;,
                4: &#39;/home/travis/build/aleaf/modflow-setup/examples/data/pleasant/source_data/rasters/botm3.tif&#39;}}},
             &#39;nlay&#39;: 4})
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">inset</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;plsnt_lgr_inset&#39;: plsnt_lgr_inset model:
 5 layer(s), 70 row(s), 80 column(s), 13 stress period(s)
 Parent model: ./plsnt_lgr_parent
 CRS: epsg:3070
 (epsg: 3070)
 Bounds: (554200.0, 557400.0, 389000.0, 391800.0)
 Grid spacing: 40.00 meters
 Packages: dis ic npf sto rcha oc sfr_0 lak_0 obs_0 wel_0 obs_1}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">inset</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">inset</span><span class="p">[</span><span class="s1">&#39;plsnt_lgr_inset&#39;</span><span class="p">]</span>

<span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">extent</span>
<span class="n">layer</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">parent_mv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span>
<span class="n">inset_mv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">inset</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span>

<span class="n">vconn</span> <span class="o">=</span> <span class="n">inset</span><span class="o">.</span><span class="n">lak</span><span class="o">.</span><span class="n">connectiondata</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="n">inset</span><span class="o">.</span><span class="n">lak</span><span class="o">.</span><span class="n">connectiondata</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;claktype&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;vertical&#39;</span><span class="p">]</span>
<span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cellids_to_kij</span><span class="p">(</span><span class="n">vconn</span><span class="p">[</span><span class="s1">&#39;cellid&#39;</span><span class="p">])</span>
<span class="n">lakeconnections</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">inset</span><span class="o">.</span><span class="n">nrow</span><span class="p">,</span> <span class="n">inset</span><span class="o">.</span><span class="n">ncol</span><span class="p">))</span>
<span class="n">lakeconnections</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">lakeconnections</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">lakeconnections</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">lakeconnections</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">qmi</span> <span class="o">=</span> <span class="n">inset_mv</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">lakeconnections</span><span class="p">)</span>

<span class="c1">#inset_mv.plot_bc(&#39;LAK&#39;, color=&#39;navy&#39;)</span>
<span class="c1">#parent_mv.plot_bc(&#39;WEL_0&#39;, color=&#39;red&#39;)</span>

<span class="n">lcp</span> <span class="o">=</span> <span class="n">parent_mv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">lci</span> <span class="o">=</span> <span class="n">inset_mv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">qmi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.colorbar.Colorbar at 0x7fef465c7610&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Pleasant_lake_lgr_example_7_1.png" src="../_images/notebooks_Pleasant_lake_lgr_example_7_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">write_input</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
writing simulation...
  writing simulation name file...
  writing simulation tdis package...
  writing ims package ims_-1...
  writing mvr package pleasant_lgr.mvr...
  writing package pleasant_lgr.gwfgwf...
  writing model plsnt_lgr_parent...
    writing model name file...
    writing package dis...
    writing package ic...
    writing package npf...
    writing package sto...
    writing package rcha...
    writing package oc...
    writing package sfr_0...
    writing package wel_0...
INFORMATION: maxbound in (&#39;gwf6&#39;, &#39;wel&#39;, &#39;dimensions&#39;) changed to 2 based on size of stress_period_data
    writing package obs_0...
    writing package chd_0...
INFORMATION: maxbound in (&#39;gwf6&#39;, &#39;chd&#39;, &#39;dimensions&#39;) changed to 235 based on size of stress_period_data
  writing model plsnt_lgr_inset...
    writing model name file...
    writing package dis...
    writing package ic...
    writing package npf...
    writing package sto...
    writing package rcha...
    writing package oc...
    writing package sfr_0...
    writing package lak_0...
    writing package obs_0...
    writing package wel_0...
INFORMATION: maxbound in (&#39;gwf6&#39;, &#39;wel&#39;, &#39;dimensions&#39;) changed to 2 based on size of stress_period_data
    writing package obs_1...
SFRmaker v. 0.6.0.post5+g78c82fe

Running Flopy v. 3.3.3 diagnostics...
passed.

Checking for continuity in segment and reach numbering...
passed.

Checking for increasing segment numbers in downstream direction...
passed.

Checking for circular routing...
passed.

No DIS package or SpatialReference object; cannot check reach proximities.

Checking for model cells with multiple non-zero SFR conductances...
passed.

Checking for streambed tops of less than -10...
isfropt setting of 1,2 or 3 requires strtop information!


Checking for streambed tops of greater than 15000...
isfropt setting of 1,2 or 3 requires strtop information!


Checking segment_data for downstream rises in streambed elevation...
Segment elevup and elevdn not specified for nstrm=-10 and isfropt=1
passed.

Checking reach_data for downstream rises in streambed elevation...
2 reaches encountered with strtop &lt; strtop of downstream reach.
Elevation rises:
k i j iseg ireach strtop strtopdn d_strtop reachID diff
4 21 17 2 1 290.3638610839844 294.76507568359375 4.401214599609375 4 -4.401214599609375
4 21 18 2 2 290.3638610839844 293.5867614746094 3.222900390625 5 -3.222900390625


Checking reach_data for inconsistencies between streambed elevations and the model grid...
passed.

Checking segment_data for inconsistencies between segment end elevations and the model grid...
Segment elevup and elevdn not specified for nstrm=-10 and isfropt=1
passed.

Checking for streambed slopes of less than 0.0001...
passed.

Checking for streambed slopes of greater than 1.0...
passed.

wrote plsnt_lgr_parent_SFR.chk
wrote plsnt_lgr_parent.sfr.obs
converting reach and segment data to package data...
wrote ./external/plsnt_lgr_parent_packagedata.dat
wrote ./plsnt_lgr_parent.sfr
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FloPy is using the following  executable to run the model: /home/travis/build/aleaf/modflow-setup/bin/linux/mf6
                                   MODFLOW 6
                U.S. GEOLOGICAL SURVEY MODULAR HYDROLOGIC MODEL
                            VERSION 6.1.0 12/12/2019

   MODFLOW 6 compiled Dec 13 2019 11:34:14 with IFORT compiler (ver. 18.0.3)

This software has been approved for release by the U.S. Geological
Survey (USGS). Although the software has been subjected to rigorous
review, the USGS reserves the right to update the software as needed
pursuant to further analysis and review. No warranty, expressed or
implied, is made by the USGS or the U.S. Government as to the
functionality of the software and related material nor shall the
fact of release constitute any such warranty. Furthermore, the
software is released on condition that neither the USGS nor the U.S.
Government shall be held liable for any damages resulting from its
authorized or unauthorized use. Also refer to the USGS Water
Resources Software User Rights Notice for complete use, copyright,
and distribution information.

 Run start date and time (yyyy/mm/dd hh:mm:ss): 2020/11/11 17:04:54

 Writing simulation list file: mfsim.lst
 Using Simulation name file: mfsim.nam
 Solving:  Stress period:     1    Time step:     1
 Solving:  Stress period:     2    Time step:     1
 Solving:  Stress period:     3    Time step:     1
 Solving:  Stress period:     4    Time step:     1
 Solving:  Stress period:     5    Time step:     1
 Solving:  Stress period:     6    Time step:     1
 Solving:  Stress period:     7    Time step:     1
 Solving:  Stress period:     8    Time step:     1
 Solving:  Stress period:     9    Time step:     1
 Solving:  Stress period:    10    Time step:     1
 Solving:  Stress period:    11    Time step:     1
 Solving:  Stress period:    12    Time step:     1
 Solving:  Stress period:    13    Time step:     1
 Run end date and time (yyyy/mm/dd hh:mm:ss): 2020/11/11 17:04:58
 Elapsed run time:  4.211 Seconds

 Normal termination of simulation.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(True, [])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;/home/travis/build/aleaf/modflow-setup/examples/pleasant_lgr&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tmr_parent_headsobj</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">HeadFile</span><span class="p">(</span><span class="s1">&#39;../data/pleasant/pleasant.hds&#39;</span><span class="p">)</span>
<span class="n">lgr_parent_headsobj</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">HeadFile</span><span class="p">(</span><span class="s1">&#39;plsnt_lgr_parent.hds&#39;</span><span class="p">)</span>
<span class="n">lgr_inset_headsobj</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">HeadFile</span><span class="p">(</span><span class="s1">&#39;plsnt_lgr_inset.hds&#39;</span><span class="p">)</span>

<span class="n">tmr_parent_hds</span> <span class="o">=</span> <span class="n">tmr_parent_headsobj</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">kstpkper</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">lgr_parent_hds</span> <span class="o">=</span> <span class="n">lgr_parent_headsobj</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">kstpkper</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">lgr_inset_hds</span> <span class="o">=</span> <span class="n">lgr_inset_headsobj</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">kstpkper</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">lgr_parent_hds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">lgr_parent_hds</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">lgr_parent_hds</span> <span class="o">==</span> <span class="mf">1e30</span><span class="p">)</span>
<span class="n">lgr_inset_hds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">lgr_inset_hds</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">lgr_inset_hds</span> <span class="o">==</span> <span class="mf">1e30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">layer</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">parent_mv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span>
<span class="n">inset_mv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">inset</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span>

<span class="n">pctr</span> <span class="o">=</span> <span class="n">parent_mv</span><span class="o">.</span><span class="n">contour_array</span><span class="p">(</span><span class="n">lgr_parent_hds</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">290</span><span class="p">,</span> <span class="mi">315</span><span class="p">))</span>
<span class="n">ictr</span> <span class="o">=</span> <span class="n">inset_mv</span><span class="o">.</span><span class="n">contour_array</span><span class="p">(</span><span class="n">lgr_inset_hds</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">290</span><span class="p">,</span> <span class="mi">315</span><span class="p">))</span>
<span class="c1">#qmp = parent_mv.plot_array(lgr_parent_hds)</span>
<span class="c1">#qmi = inset_mv.plot_array(lgr_inset_hds)</span>

<span class="n">lcp</span> <span class="o">=</span> <span class="n">parent_mv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">lci</span> <span class="o">=</span> <span class="n">inset_mv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#plt.colorbar(qmp)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Pleasant_lake_lgr_example_12_0.png" src="../_images/notebooks_Pleasant_lake_lgr_example_12_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">m</span><span class="p">,</span> <span class="n">inset</span><span class="p">:</span>
    <span class="n">mfexport</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">modelgrid</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="s1">&#39;postproc/</span><span class="si">{}</span><span class="s1">/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
creating postproc/plsnt_lgr_parent/pdfs...
creating postproc/plsnt_lgr_parent/shps...
creating postproc/plsnt_lgr_parent/rasters...

dis package...
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay4.tif
top:
wrote postproc/plsnt_lgr_parent/rasters/top.tif
botm:
wrote postproc/plsnt_lgr_parent/rasters/botm_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/botm_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/botm_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/botm_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/botm_lay4.tif
idomain:
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay4.tif

ic package...
strt:
wrote postproc/plsnt_lgr_parent/rasters/strt_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/strt_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/strt_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/strt_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/strt_lay4.tif

npf package...
icelltype:
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay4.tif
k:
wrote postproc/plsnt_lgr_parent/rasters/k_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/k_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/k_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/k_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/k_lay4.tif
k33:
wrote postproc/plsnt_lgr_parent/rasters/k33_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/k33_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/k33_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/k33_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/k33_lay4.tif

sto package...
iconvert:
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay4.tif
ss:
wrote postproc/plsnt_lgr_parent/rasters/ss_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/ss_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/ss_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/ss_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/ss_lay4.tif
sy:
wrote postproc/plsnt_lgr_parent/rasters/sy_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/sy_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/sy_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/sy_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/sy_lay4.tif

rcha package...
irch:
wrote postproc/plsnt_lgr_parent/rasters/irch_per0.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per1.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per2.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per3.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per4.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per5.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per6.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per7.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per8.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per9.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per10.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per11.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per12.tif
recharge:
wrote postproc/plsnt_lgr_parent/rasters/recharge_per0.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per1.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per2.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per3.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per4.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per5.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per6.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per7.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per8.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per9.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per10.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per11.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per12.tif

sfr_0 package...

wel_0 package...
writing postproc/plsnt_lgr_parent/shps/wel0_stress_period_data.shp... Done
q:
boundname:
Warning, variable: boundname
Export of non-period data from transientlists not implemented!

obs_0 package...
writing postproc/plsnt_lgr_parent/shps/obs0_stress_period_data.shp... Done

chd_0 package...
writing postproc/plsnt_lgr_parent/shps/chd0_stress_period_data.shp... Done
head:
creating postproc/plsnt_lgr_inset/pdfs...
creating postproc/plsnt_lgr_inset/shps...
creating postproc/plsnt_lgr_inset/rasters...

dis package...
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay4.tif
top:
wrote postproc/plsnt_lgr_inset/rasters/top.tif
botm:
wrote postproc/plsnt_lgr_inset/rasters/botm_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/botm_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/botm_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/botm_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/botm_lay4.tif
idomain:
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay4.tif

ic package...
strt:
wrote postproc/plsnt_lgr_inset/rasters/strt_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/strt_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/strt_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/strt_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/strt_lay4.tif

npf package...
icelltype:
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay4.tif
k:
wrote postproc/plsnt_lgr_inset/rasters/k_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/k_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/k_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/k_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/k_lay4.tif
k33:
wrote postproc/plsnt_lgr_inset/rasters/k33_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/k33_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/k33_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/k33_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/k33_lay4.tif

sto package...
iconvert:
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay4.tif
ss:
wrote postproc/plsnt_lgr_inset/rasters/ss_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/ss_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/ss_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/ss_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/ss_lay4.tif
sy:
wrote postproc/plsnt_lgr_inset/rasters/sy_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/sy_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/sy_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/sy_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/sy_lay4.tif

rcha package...
irch:
wrote postproc/plsnt_lgr_inset/rasters/irch_per0.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per1.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per2.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per3.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per4.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per5.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per6.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per7.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per8.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per9.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per10.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per11.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per12.tif
recharge:
wrote postproc/plsnt_lgr_inset/rasters/recharge_per0.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per1.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per2.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per3.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per4.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per5.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per6.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per7.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per8.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per9.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per10.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per11.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per12.tif

sfr_0 package...

lak_0 package...
skipped, not implemented yet

obs_0 package...
skipped, not implemented yet

wel_0 package...
writing postproc/plsnt_lgr_inset/shps/wel0_stress_period_data.shp... Done
q:
boundname:
Warning, variable: boundname
Export of non-period data from transientlists not implemented!

obs_1 package...
writing postproc/plsnt_lgr_inset/shps/obs1_stress_period_data.shp... Done
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">m</span><span class="p">,</span> <span class="n">inset</span><span class="p">:</span>
    <span class="n">mfexport</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="s1">&#39;postproc/</span><span class="si">{}</span><span class="s1">/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
summarizing plsnt_lgr_parent input...
summarizing plsnt_lgr_inset input...
skipped, not implemented yet
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">outpath</span><span class="o">=</span><span class="s1">&#39;postproc/</span><span class="si">{}</span><span class="s1">/shps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inset</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">outpath</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">outpath</span><span class="p">)</span>
<span class="n">connectiondata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">inset</span><span class="o">.</span><span class="n">lak</span><span class="o">.</span><span class="n">connectiondata</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cellids_to_kij</span><span class="p">(</span><span class="n">connectiondata</span><span class="p">[</span><span class="s1">&#39;cellid&#39;</span><span class="p">])</span>
<span class="n">connectiondata</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
<span class="n">connectiondata</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="n">connectiondata</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
<span class="n">connectiondata</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;cellid&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">polygons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">inset</span><span class="o">.</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">polygons</span><span class="p">,</span> <span class="p">(</span><span class="n">inset</span><span class="o">.</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">nrow</span><span class="p">,</span> <span class="n">inset</span><span class="o">.</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">ncol</span><span class="p">))</span>
<span class="n">connectiondata</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">polygons</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
<span class="n">df2shp</span><span class="p">(</span><span class="n">connectiondata</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="s1">&#39;lake_connections.shp&#39;</span><span class="p">),</span> <span class="n">epsg</span><span class="o">=</span><span class="mi">3070</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
creating shapely Polygons of grid cells...
finished in 0.03s

writing postproc/plsnt_lgr_inset/shps/lake_connections.shp... Done
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../config-file-gallery.html" class="btn btn-neutral float-right" title="Configuration File Gallery" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019-2020, Modflow-setup developers |
      <span class="lastupdated">
        Last updated on Nov 11, 2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>