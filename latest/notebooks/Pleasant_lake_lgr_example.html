<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pleasant Lake Example &mdash; modflow-setup 0.post269+g820f114 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configuration File Gallery" href="../config-file-gallery.html" />
    <link rel="prev" title="Examples" href="../examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> modflow-setup
          </a>
              <div class="version">
                0.post269+g820f114
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../philosophy.html">     Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html"> Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html"> Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pleasant Lake Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Model-details">Model details</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Just-make-a-model-grid">Just make a model grid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Working-directory-gottcha">Working directory gottcha</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Write-shapefiles-of-the-inset-and-parent-modelgrids">Write shapefiles of the inset and parent modelgrids</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Build-the-whole-model">Build the whole model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Plot-the-inset-and-parent-model-grids-with-Lake-Package-connections-by-layer">Plot the inset and parent model grids with Lake Package connections by layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#write-the-MODFLOW-input-files">write the MODFLOW input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Run-the-model">Run the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Plot-the-head-results">Plot the head results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Use-Modflow-export-to-export-the-modflow-input-to-PDFs,-rasters-and-shapefiles">Use Modflow-export to export the modflow input to PDFs, rasters and shapefiles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Modflow-export-can-also-create-a-summary-table-of-the-model-inputs">Modflow-export can also create a summary table of the model inputs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../config-file-gallery.html"> Configuration File Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../structure.html"> Basic program structure and usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config-file.html"> The configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html"> Concepts and methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html"> Input instructions by package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html"> Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html"> Code reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config-file-defaults.html"> Configuration file defaults</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html"> Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html"> Contributing to modflow-setup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html"> References cited</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">modflow-setup</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../examples.html">Examples</a> &raquo;</li>
      <li>Pleasant Lake Example</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/Pleasant_lake_lgr_example.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Pleasant-Lake-Example">
<h1>Pleasant Lake Example<a class="headerlink" href="#Pleasant-Lake-Example" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="https://aleaf.github.io/modflow-setup/latest/config-file-gallery.html#pleasant-lake-test-case">View the configuration file(s)</a></p></li>
<li><p><a class="reference external" href="https://mybinder.org/v2/gh/aleaf/modflow-setup/develop?urlpath=lab/tree/examples">Run this example</a><strong>on</strong><a class="reference external" href="https://mybinder.org/">Binder</a></p></li>
</ul>
<section id="Model-details">
<h2>Model details<a class="headerlink" href="#Model-details" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>MODFLOW-6 model with local grid refinement (LGR)</p></li>
<li><p>LGR parent model is itself a Telescopic Mesh Refinment (TMR) inset from a MODFLOW-NWT model</p></li>
<li><p>Layer 1 in TMR parent model is subdivided evenly into two layers in LGR model (<code class="docutils literal notranslate"><span class="pre">botm:</span> <span class="pre">from_parent:</span> <span class="pre">0:</span> <span class="pre">-0.5</span></code>). Other layers mapped explicitly between TMR parent and LGR model.</p></li>
<li><p>starting heads from LGR parent model resampled from binary output from the TMR parent</p></li>
<li><p>rch, npf, sto, and wel input copied from parent model</p></li>
<li><p>SFR package constructed from an NHDPlus v2 dataset (path to NHDPlus files in the same structure as the <code class="docutils literal notranslate"><span class="pre">downloads</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">NHDPlus</span> <span class="pre">website</span></code>_)</p></li>
<li><p>head observations from csv files with different column names</p></li>
<li><p>LGR inset extent based on a buffer distance around a feature of interest</p></li>
<li><p>LGR inset dis, ic, npf, sto and rch packages copied from LGR parent</p></li>
<li><p>WEL package created from custom format</p></li>
<li><p>Lake package created from polygon features, bathymetry raster, stage-area-volume file and climate data from <code class="docutils literal notranslate"><span class="pre">PRISM</span></code>_.</p></li>
<li><p>Lake package observations set up automatically (output file for each lake)</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">flopy</span>
<span class="kn">import</span> <span class="nn">flopy.utils.binaryfile</span> <span class="k">as</span> <span class="nn">bf</span>
<span class="kn">from</span> <span class="nn">mfsetup</span> <span class="kn">import</span> <span class="n">MF6model</span>
<span class="kn">from</span> <span class="nn">mfsetup.discretization</span> <span class="kn">import</span> <span class="n">cellids_to_kij</span>
<span class="kn">from</span> <span class="nn">gisutils</span> <span class="kn">import</span> <span class="n">df2shp</span>
<span class="kn">import</span> <span class="nn">mfexport</span>

<span class="n">wd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
<section id="Just-make-a-model-grid">
<h3>Just make a model grid<a class="headerlink" href="#Just-make-a-model-grid" title="Permalink to this headline">¶</a></h3>
<p>Oftentimes at the start of a modeling project, we want to quickly test different grid resolutions and extents before attempting to build the model. We can do this with Modflow-setup by creating a model instance and then running the <code class="docutils literal notranslate"><span class="pre">setup_grid()</span></code> method. A model grid instance is created from the <code class="docutils literal notranslate"><span class="pre">setup_grid:</span></code> block in the configuration file.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">%%capture</span></code> in the block below is just to suppress printing of <code class="docutils literal notranslate"><span class="pre">stdout</span></code> for display of this notebook in the modflow-setup documentation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%capture</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MF6model</span><span class="p">(</span><span class="n">cfg</span><span class="o">=</span><span class="s1">&#39;pleasant_lgr_parent.yml&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">setup_grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Since this model has local-grid refinement, it actually consists of two models: a parent built from <code class="docutils literal notranslate"><span class="pre">pleasant_lgr_parent.yml</span></code>, and an inset built from <code class="docutils literal notranslate"><span class="pre">pleasant_lgr_inset.yml</span></code>, which is referenced within <code class="docutils literal notranslate"><span class="pre">pleasant_lgr_parent.yml</span></code>. The two sub-models are connected and solved simulataneously within the same MODFLOW 6 simulation. A model grid is made for each sub-model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">modelgrid</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5 layer(s), 25 row(s), 25 column(s)
delr: [200.00...200.00] meters
delc: [200.00...200.00] meters
CRS: EPSG:3070
length units: meters
xll: 553000.0; yll: 388000.0; rotation: 0.0
Bounds: (553000.0, 558000.0, 388000.0, 393000.0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">inset</span><span class="p">[</span><span class="s1">&#39;plsnt_lgr_inset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">modelgrid</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
70 row(s), 80 column(s)
delr: [40.00...40.00] meters
delc: [40.00...40.00] meters
CRS: EPSG:3070
length units: meters
xll: 554200.0; yll: 389000.0; rotation: 0.0
Bounds: (554200.0, 557400.0, 389000.0, 391800.0)
</pre></div></div>
</div>
</section>
</section>
<section id="Working-directory-gottcha">
<h2>Working directory gottcha<a class="headerlink" href="#Working-directory-gottcha" title="Permalink to this headline">¶</a></h2>
<p>Currently, to facilitate working with external files in Flopy, Modflow-setup changes the working directory to the model workspace. In the context of a flat script that only builds the model, this is fine, but in a notebook or other workflows, this can potentially cause confusion.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;/home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr&#39;
</pre></div></div>
</div>
<section id="Write-shapefiles-of-the-inset-and-parent-modelgrids">
<h3>Write shapefiles of the inset and parent modelgrids<a class="headerlink" href="#Write-shapefiles-of-the-inset-and-parent-modelgrids" title="Permalink to this headline">¶</a></h3>
<p>A shapefile of the grid bounding box is written by default on creation of the model grid, to the location specified by <code class="docutils literal notranslate"><span class="pre">output_files:</span> <span class="pre">grid_file:</span></code> in the <code class="docutils literal notranslate"><span class="pre">setup_grid:</span></code> block (default is <code class="docutils literal notranslate"><span class="pre">&lt;model</span> <span class="pre">workspace&gt;/postproc/shps/</span></code>)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">write_shapefile</span><span class="p">(</span><span class="s1">&#39;postproc/shps/plsnt_lgr_parent_grid.shp&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">inset</span><span class="p">[</span><span class="s1">&#39;plsnt_lgr_inset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">write_shapefile</span><span class="p">(</span><span class="s1">&#39;postproc/shps/plsnt_lgr_inset_grid.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
creating shapely Polygons of grid cells...
finished in 0.01s

writing postproc/shps/plsnt_lgr_parent_grid.shp... Done
creating shapely Polygons of grid cells...
finished in 0.06s

writing postproc/shps/plsnt_lgr_inset_grid.shp... Done
</pre></div></div>
</div>
<section id="Change-the-working-directory-back-to-the-notebook-location">
<h4>Change the working directory back to the notebook location<a class="headerlink" href="#Change-the-working-directory-back-to-the-notebook-location" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">wd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Build-the-whole-model">
<h3>Build the whole model<a class="headerlink" href="#Build-the-whole-model" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span> <span class="o">=</span> <span class="n">MF6model</span><span class="o">.</span><span class="n">setup_from_yaml</span><span class="p">(</span><span class="s1">&#39;pleasant_lgr_parent.yml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
loading configuration file pleasant_lgr_parent.yml...

Setting up plsnt_lgr_parent model from configuration in pleasant_lgr_parent.yml
loading parent model /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/pleasant.nam...
finished in 0.16s


validating configuration...
DIS package
done with validation.

setting up model grid...
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp... Done
finished in 0.02s

loading configuration file /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr_inset.yml...

Setting up DIS package...
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/dem40m.tif...
finished in 0.02s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm0.tif...
finished in 0.02s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm1.tif...
finished in 0.02s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm2.tif...
finished in 0.02s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm3.tif...
finished in 0.03s
loading original/plsnt_lgr_parent_top.dat.original, shape=(25, 25), took 0.00s
computing cell thicknesses...
finished in 0.03s

wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_004.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_004.dat, took 0.00s
(re)setting the idomain array...
computing cell thicknesses...
finished in 0.02s

setting up model grid...
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp... Done
finished in 0.01s

loading configuration file /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr_inset.yml...
wrote original/plsnt_lgr_parent_lakarr_000.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_001.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_002.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_003.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_004.dat, took 0.00s
loading original/plsnt_lgr_parent_top.dat.original, shape=(25, 25), took 0.00s
computing cell thicknesses...
finished in 0.02s

wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_004.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_004.dat, took 0.00s
setting up model grid...
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp... Done
finished in 0.01s

loading configuration file /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr_inset.yml...
wrote ./external/plsnt_lgr_parent_irch.dat, took 0.00s
finished in 0.39s


validating configuration...
DIS package
done with validation.

setting up model grid...

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
filtering on bounding box 553000.0, 388000.0, 558000.0, 393000.0...
--&gt; building dataframe... (may take a while for large shapefiles)
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp... Done
finished in 0.28s

(re)setting the idomain array...
computing cell thicknesses...
finished in 0.04s

wrote original/plsnt_lgr_parent_lakarr_000.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_001.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_002.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_003.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_004.dat, took 0.00s
loading original/plsnt_lgr_parent_top.dat.original, shape=(25, 25), took 0.00s
computing cell thicknesses...
finished in 0.02s

wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_004.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_004.dat, took 0.00s
setting up model grid...
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp... Done
finished in 0.01s

wrote ./external/plsnt_lgr_parent_irch.dat, took 0.00s

Setting up TDIS package...
finished in 0.00s


Setting up IMS package...
finished in 0.00s


Setting up IC package...
getting i, j locations...
finished in 0.00s

wrote ./external/plsnt_lgr_parent_strt_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_strt_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_strt_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_strt_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_strt_004.dat, took 0.00s
finished in 0.48s


Setting up NPF package...
wrote ./external/plsnt_lgr_parent_k_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k_004.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k33_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k33_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k33_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k33_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_k33_004.dat, took 0.00s
finished in 0.17s


Setting up STO package...
wrote ./external/plsnt_lgr_parent_sy_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_sy_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_sy_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_sy_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_sy_004.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_ss_004.dat, took 0.00s
finished in 0.17s


Setting up RCH package...
wrote ./external/plsnt_lgr_parent_irch.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_004.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_005.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_006.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_007.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_008.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_009.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_010.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_011.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_rch_012.dat, took 0.00s
finished in 0.03s


Setting up OC package...
finished in 0.00s


Setting up CHD package...

getting perimeter cells...
creating shapely Polygons of grid cells...
finished in 0.01s

wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/tables/boundary_cells.shp
perimeter cells took 0.17s

Calculating 3D interpolation weights...
finished in 0.37s


getting perimeter heads...
for stress period 0, took 0.01s
for stress period 1, took 0.01s
for stress period 2, took 0.01s
for stress period 3, took 0.01s
for stress period 4, took 0.01s
for stress period 5, took 0.01s
for stress period 6, took 0.01s
for stress period 7, took 0.01s
for stress period 8, took 0.01s
for stress period 9, took 0.01s
for stress period 10, took 0.01s
for stress period 11, took 0.01s
for stress period 12, took 0.01s
getting perimeter heads took 0.09s

No other CHD input specified
setup of chd took 0.69s


Setting up SFR package...

loading NHDPlus v2 hydrography data...
for basins:
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/NHDSnapshot/Hydrography/NHDFlowline.shp...
filtering on bounding box -89.58864189423825, 43.964148922793996, -89.52595875596734, 44.00940678140979...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/PlusFlowlineVAA.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/PlusFlow.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/elevslope.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

load finished in 0.05s

Getting routing information from NHDPlus Plusflow table...
finished in 0.01s


SFRmaker version 0.8.0.post24+g7e66d67

Creating sfr dataset...

Creating grid class instance from flopy Grid instance...
grid class created in 0.02s

Model grid information
structured grid
nnodes: 625
nlay: 1
nrow: 25
ncol: 25
model length units: undefined
crs: EPSG:3070
bounds: 553000.00, 388000.00, 558000.00, 393000.00
active area defined by: isfr array

/home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr
Pleasant Lake test case version 0.1.post269+g820f114
Parent model: /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/pleasant
5 layer(s), 25 row(s), 25 column(s)
delr: [200.00...200.00] meters
delc: [200.00...200.00] meters
CRS: EPSG:3070
length units: meters
xll: 553000.0; yll: 388000.0; rotation: 0.0
Bounds: (553000.0, 558000.0, 388000.0, 393000.0)
Packages: dis ic npf sto rcha_0 oc chd_0 obs_0
13 period(s):
 per start_datetime end_datetime  perlen  steady  nstp
   0     2012-01-01   2012-01-01     1.0    True     1
   1     2012-01-01   2012-02-01    31.0   False     1
   2     2012-02-01   2012-03-01    29.0   False     1
   ...
  12     2012-12-01   2013-01-01    31.0   False     1
Warning: No length units specified in CRS for input LineStrings or length units not recognizeddefaulting to meters.

reprojecting hydrography from
EPSG:4269
to
EPSG:3070


Culling hydrography to active area...
simplification tolerance: 2000.00
starting lines: 2
remaining lines: 2
finished in 0.00s


Intersecting 2 flowlines with 625 grid cells...
Intersecting 2 features...
2
finished in 0.00s

Setting up reach data... (may take a few minutes for large grids)
finished in 0.01s

Computing widths...

Dropping 0 reaches with length &lt; 10.00 meters...

Repairing routing connections...
enforcing best segment numbering...

Setting up segment data...
Model grid information
structured grid
nnodes: 625
nlay: 1
nrow: 25
ncol: 25
model length units: undefined
crs: EPSG:3070
bounds: 553000.00, 388000.00, 558000.00, 393000.00
active area defined by: isfr array


Time to create sfr dataset: 0.20s

running rasterstats.zonal_stats on buffered LineStrings...
finished in 0.20s


Smoothing elevations...
finished in 0.00s
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/tables/plsnt_lgr_parent_sfr_reach_data.csv
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/tables/plsnt_lgr_parent_sfr_segment_data.csv
converting segment data to period data...
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_cells.shp... Done
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_outlets.shp... Done
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_lines.shp... Done
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_routing.shp... Done
No period data to export!
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_sfr_observations.shp... Done
No non-zero values of flow to export!
converting reach and segment data to package data...
converting segment data to period data...
(re)setting the idomain array...
computing cell thicknesses...
finished in 0.02s

wrote original/plsnt_lgr_parent_lakarr_000.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_001.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_002.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_003.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_004.dat, took 0.00s
loading original/plsnt_lgr_parent_top.dat.original, shape=(25, 25), took 0.00s
computing cell thicknesses...
finished in 0.04s

wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_botm_004.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_top.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_000.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_001.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_002.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_003.dat, took 0.00s
wrote ./external/plsnt_lgr_parent_idomain_004.dat, took 0.00s
setting up model grid...
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/plsnt_lgr_parent_grid.json
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_parent_bbox.shp... Done
finished in 0.02s

wrote ./external/plsnt_lgr_parent_irch.dat, took 0.00s
finished in 0.87s


Setting up LAK package...
wrote original/plsnt_lgr_parent_lakarr_000.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_001.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_002.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_003.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_004.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_000.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_001.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_002.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_003.dat, took 0.00s
wrote original/plsnt_lgr_parent_lakarr_004.dat, took 0.00s
lakes_shapefile not specified, or no lakes in model area

Setting up WEL package...
getting i, j locations...
finished in 0.00s

finished in 0.08s


Setting up OBS package...
Reading observation files...
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/nwis_heads_info_file.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/lake_sites.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/wdnr_gw_sites.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/uwsp_heads.csv
    observation type col: obs_type
    observation label column: obsnme
    observation label column: obsnme
    x location col: x
    y location col: y
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/wgnhs_head_targets.csv
    observation type col: obs_type
    observation label column: common_name
    observation label column: common_name
    x location col: x
    y location col: y

Culling observations to model area...
Dropping head observations that coincide with boundary conditions...
getting i, j locations...
finished in 0.00s

Dropping head observations specified in /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr_parent.yml...
finished in 0.07s


Setting up DIS package...
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/dem40m.tif...
finished in 0.02s
wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm0.tif...
finished in 0.02s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm1.tif...
finished in 0.02s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm2.tif...
finished in 0.02s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm3.tif...
finished in 0.02s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.14s

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
filtering on bounding box 554200.0, 389000.0, 557400.0, 391800.0...
--&gt; building dataframe... (may take a while for large shapefiles)
caching data in /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.13s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.13s
loading original/plsnt_lgr_inset_top.dat.original, shape=(70, 80), loading original/plsnt_lgr_inset_top.dat.original, shape=(70, 80), took 0.00s
computing cell thicknesses...
finished in 0.23s

wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_004.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_004.dat, took 0.00s
(re)setting the idomain array...
computing cell thicknesses...
finished in 0.24s

setting up model grid...

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
filtering on bounding box 553000.0, 388000.0, 558000.0, 393000.0...
--&gt; building dataframe... (may take a while for large shapefiles)
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp... Done
finished in 0.28s

reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.13s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.14s
wrote original/plsnt_lgr_inset_lakarr_000.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_001.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_002.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_003.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_004.dat, took 0.00s
loading original/plsnt_lgr_inset_top.dat.original, shape=(70, 80), took 0.01s
computing cell thicknesses...
finished in 0.24s

wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_004.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_004.dat, took 0.00s
setting up model grid...

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
filtering on bounding box 553000.0, 388000.0, 558000.0, 393000.0...
--&gt; building dataframe... (may take a while for large shapefiles)
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp... Done
finished in 0.28s

wrote ./external/plsnt_lgr_inset_irch.dat, took 0.00s
finished in 2.48s


Setting up IC package...
getting i, j locations...
finished in 0.00s

wrote ./external/plsnt_lgr_inset_strt_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_strt_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_strt_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_strt_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_strt_004.dat, took 0.00s
finished in 0.21s


Setting up NPF package...
wrote ./external/plsnt_lgr_inset_k_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_k_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_k_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_k_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_k_004.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_k33_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_k33_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_k33_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_k33_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_k33_004.dat, took 0.00s
finished in 0.43s


Setting up STO package...
wrote ./external/plsnt_lgr_inset_sy_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_sy_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_sy_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_sy_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_sy_004.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_ss_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_ss_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_ss_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_ss_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_ss_004.dat, took 0.00s
finished in 0.44s


Setting up RCH package...
wrote ./external/plsnt_lgr_inset_irch.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_004.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_005.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_006.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_007.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_008.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_009.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_010.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_011.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_rch_012.dat, took 0.00s
finished in 0.11s


Setting up OC package...
finished in 0.00s


Setting up SFR package...

loading NHDPlus v2 hydrography data...
for basins:
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/NHDSnapshot/Hydrography/NHDFlowline.shp...
filtering on bounding box -89.57361941749177, 43.97318294263003, -89.53352803700078, 43.99854796302356...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/PlusFlowlineVAA.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/PlusFlow.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/NHDPlusAttributes/elevslope.dbf...
--&gt; building dataframe... (may take a while for large shapefiles)

load finished in 0.04s

Getting routing information from NHDPlus Plusflow table...
finished in 0.01s

reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.13s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.13s

SFRmaker version 0.8.0.post24+g7e66d67

Creating sfr dataset...

Creating grid class instance from flopy Grid instance...
grid class created in 0.19s

Model grid information
structured grid
nnodes: 5,600
nlay: 1
nrow: 70
ncol: 80
model length units: undefined
crs: EPSG:3070
bounds: 554200.00, 389000.00, 557400.00, 391800.00
active area defined by: isfr array

/home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr
plsnt_lgr_inset model version 0.post269+g820f114
Parent model: ./plsnt_lgr_parent
5 layer(s), 70 row(s), 80 column(s)
delr: [40.00...40.00] meters
delc: [40.00...40.00] meters
CRS: EPSG:3070
length units: meters
xll: 554200.0; yll: 389000.0; rotation: 0.0
Bounds: (554200.0, 557400.0, 389000.0, 391800.0)
Packages: dis ic npf sto rcha_0 oc
13 period(s):
 per start_datetime end_datetime  perlen  steady  nstp
   0     2012-01-01   2012-01-01     1.0    True     1
   1     2012-01-01   2012-02-01    31.0   False     1
   2     2012-02-01   2012-03-01    29.0   False     1
   ...
  12     2012-12-01   2013-01-01    31.0   False     1
Warning: No length units specified in CRS for input LineStrings or length units not recognizeddefaulting to meters.

reprojecting hydrography from
EPSG:4269
to
EPSG:3070


Culling hydrography to active area...
simplification tolerance: 2000.00
starting lines: 2
remaining lines: 2
finished in 0.00s


Intersecting 2 flowlines with 5,600 grid cells...
Intersecting 2 features...
2
finished in 0.03s

Setting up reach data... (may take a few minutes for large grids)
finished in 0.01s

Computing widths...

Dropping 1 reaches with length &lt; 2.00 meters...

Repairing routing connections...
enforcing best segment numbering...

Setting up segment data...
Model grid information
structured grid
nnodes: 5,600
nlay: 1
nrow: 70
ncol: 80
model length units: undefined
crs: EPSG:3070
bounds: 554200.00, 389000.00, 557400.00, 391800.00
active area defined by: isfr array


Time to create sfr dataset: 0.42s

running rasterstats.zonal_stats on buffered LineStrings...
finished in 0.37s


Smoothing elevations...
finished in 0.00s
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/tables/plsnt_lgr_inset_sfr_reach_data.csv
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/tables/plsnt_lgr_inset_sfr_segment_data.csv
converting segment data to period data...
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_sfr_cells.shp... Done
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_sfr_outlets.shp... Done
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_sfr_lines.shp... Done
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_sfr_routing.shp... Done
No period data to export!
No observations to export!
No non-zero values of flow to export!
converting reach and segment data to package data...
converting segment data to period data...
(re)setting the idomain array...
computing cell thicknesses...
finished in 0.26s

reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.13s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.13s
wrote original/plsnt_lgr_inset_lakarr_000.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_001.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_002.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_003.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_004.dat, took 0.00s
loading original/plsnt_lgr_inset_top.dat.original, shape=(70, 80), took 0.00s
computing cell thicknesses...
finished in 0.24s

wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_botm_004.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_top.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_000.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_001.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_002.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_003.dat, took 0.00s
wrote ./external/plsnt_lgr_inset_idomain_004.dat, took 0.00s
setting up model grid...

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/all_lakes.shp...
filtering on bounding box 553000.0, 388000.0, 558000.0, 393000.0...
--&gt; building dataframe... (may take a while for large shapefiles)
wrote /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/plsnt_lgr_inset_grid.json
writing /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr/postproc/shps/plsnt_lgr_inset_bbox.shp... Done
finished in 0.28s

wrote ./external/plsnt_lgr_inset_irch.dat, took 0.00s
finished in 2.64s


Setting up LAK package...
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.13s
reading data from /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/pleasant_bathymetry.tif...
finished in 0.13s
wrote original/plsnt_lgr_inset_lakarr_000.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_001.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_002.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_003.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_004.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_000.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_001.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_002.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_003.dat, took 0.00s
wrote original/plsnt_lgr_inset_lakarr_004.dat, took 0.00s
setting up lakebed leakance zones...
finished in 0.01s
wrote original/plsnt_lgr_inset_lakzones.dat, took 0.00s
setting up tabfiles...
wrote ./external/600059060_stage_area_volume.dat
finished in 0.65s


Setting up WEL package...

reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/csls_sources_wu_pts.shp...
--&gt; building dataframe... (may take a while for large shapefiles)
intersecting wells with model grid...
getting i, j locations...
finished in 0.00s

took 0.00s

computing cell thicknesses...
finished in 0.24s


reading /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/shps/csls_sources_wu_pts.shp...
--&gt; building dataframe... (may take a while for large shapefiles)
intersecting wells with model grid...
getting i, j locations...
finished in 0.00s

took 0.00s

computing cell thicknesses...
finished in 0.23s


Resampling pumping rates in /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/master_wu.csv to model stress periods...
    wells with no data for a stress period will be assigned 0.0 pumping rates.
took 0.02s

finished in 0.84s


Setting up OBS package...
Reading observation files...
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/nwis_heads_info_file.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/lake_sites.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/wdnr_gw_sites.csv
    observation type col: obs_type
    observation label column: obsprefix
    observation label column: obsprefix
    x location col: x
    y location col: y
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/uwsp_heads.csv
    observation type col: obs_type
    observation label column: obsnme
    observation label column: obsnme
    x location col: x
    y location col: y
/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/tables/wgnhs_head_targets.csv
    observation type col: obs_type
    observation label column: common_name
    observation label column: common_name
    x location col: x
    y location col: y

Culling observations to model area...
Dropping head observations that coincide with boundary conditions...
getting i, j locations...
finished in 0.00s

dropped 3 of 83 observations in cells with bcs.
Dropping head observations specified in /home/runner/work/modflow-setup/modflow-setup/examples/pleasant_lgr_inset.yml...
finished in 0.07s


Setting up the simulation water mover package...
finished in 0.01s

finished setting up model in 12.08s

Pleasant Lake test case version 0.1.post269+g820f114
Parent model: /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/pleasant
5 layer(s), 25 row(s), 25 column(s)
delr: [200.00...200.00] meters
delc: [200.00...200.00] meters
CRS: EPSG:3070
length units: meters
xll: 553000.0; yll: 388000.0; rotation: 0.0
Bounds: (553000.0, 558000.0, 388000.0, 393000.0)
Packages: dis ic npf sto rcha_0 oc chd_0 obs_0 sfr_0 wel_0 obs_1
13 period(s):
 per start_datetime end_datetime  perlen  steady  nstp
   0     2012-01-01   2012-01-01     1.0    True     1
   1     2012-01-01   2012-02-01    31.0   False     1
   2     2012-02-01   2012-03-01    29.0   False     1
   ...
  12     2012-12-01   2013-01-01    31.0   False     1
</pre></div></div>
</div>
<p>a <code class="docutils literal notranslate"><span class="pre">MF6model</span></code> instance (subclass of <code class="docutils literal notranslate"><span class="pre">flopy.mf6.ModflowGwf</span></code>) is returned</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Pleasant Lake test case version 0.1.post269+g820f114
Parent model: /home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/pleasant
5 layer(s), 25 row(s), 25 column(s)
delr: [200.00...200.00] meters
delc: [200.00...200.00] meters
CRS: EPSG:3070
length units: meters
xll: 553000.0; yll: 388000.0; rotation: 0.0
Bounds: (553000.0, 558000.0, 388000.0, 393000.0)
Packages: dis ic npf sto rcha_0 oc chd_0 obs_0 sfr_0 wel_0 obs_1
13 period(s):
 per start_datetime end_datetime  perlen  steady  nstp
   0     2012-01-01   2012-01-01     1.0    True     1
   1     2012-01-01   2012-02-01    31.0   False     1
   2     2012-02-01   2012-03-01    29.0   False     1
   ...
  12     2012-12-01   2013-01-01    31.0   False     1
</pre></div></div>
</div>
<p>information from the configuration file is stored in an attached <code class="docutils literal notranslate"><span class="pre">cfg</span></code> dictionary</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;metadata&#39;, &#39;simulation&#39;, &#39;model&#39;, &#39;parent&#39;, &#39;intermediate_data&#39;, &#39;postprocessing&#39;, &#39;setup_grid&#39;, &#39;dis&#39;, &#39;tdis&#39;, &#39;ic&#39;, &#39;npf&#39;, &#39;sto&#39;, &#39;rch&#39;, &#39;sfr&#39;, &#39;high_k_lakes&#39;, &#39;lak&#39;, &#39;mvr&#39;, &#39;riv&#39;, &#39;wel&#39;, &#39;chd&#39;, &#39;oc&#39;, &#39;obs&#39;, &#39;ims&#39;, &#39;filename&#39;, &#39;ghb&#39;, &#39;maw&#39;, &#39;external_files&#39;, &#39;grid&#39;])
</pre></div></div>
</div>
<p>the <code class="docutils literal notranslate"><span class="pre">cfg</span></code> dictionary contains both information from the configuration file, and MODFLOW input (such as external text file arrays) that was developed from the original source data. Internally in Modflow-setup, MODFLOW input in <code class="docutils literal notranslate"><span class="pre">cfg</span></code> is fed to the various Flopy object constructors.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;dis&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
defaultdict(dict,
            {&#39;remake_top&#39;: True,
             &#39;options&#39;: {&#39;length_units&#39;: &#39;meters&#39;},
             &#39;dimensions&#39;: {&#39;nlay&#39;: 5},
             &#39;griddata&#39;: {&#39;top&#39;: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_top.dat&#39;}],
              &#39;botm&#39;: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm_000.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm_001.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm_002.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm_003.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_botm_004.dat&#39;}],
              &#39;idomain&#39;: [{&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain_000.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain_001.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain_002.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain_003.dat&#39;},
               {&#39;filename&#39;: &#39;./external/plsnt_lgr_parent_idomain_004.dat&#39;}]},
             &#39;top_filename_fmt&#39;: &#39;top.dat&#39;,
             &#39;botm_filename_fmt&#39;: &#39;botm_{:03d}.dat&#39;,
             &#39;idomain_filename_fmt&#39;: &#39;idomain_{:03d}.dat&#39;,
             &#39;minimum_layer_thickness&#39;: 1,
             &#39;drop_thin_cells&#39;: True,
             &#39;source_data&#39;: {&#39;top&#39;: {&#39;filename&#39;: &#39;/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/dem40m.tif&#39;,
               &#39;elevation_units&#39;: &#39;meters&#39;},
              &#39;botm&#39;: {&#39;filenames&#39;: {1: &#39;/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm0.tif&#39;,
                2: &#39;/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm1.tif&#39;,
                3: &#39;/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm2.tif&#39;,
                4: &#39;/home/runner/work/modflow-setup/modflow-setup/examples/data/pleasant/source_data/rasters/botm3.tif&#39;}}},
             &#39;nlay&#39;: 4})
</pre></div></div>
</div>
<p>The inset LGR model is attached to the parent within an <code class="docutils literal notranslate"><span class="pre">inset</span></code> dictionary</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">inset</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;plsnt_lgr_inset&#39;: plsnt_lgr_inset model version 0.post269+g820f114
 Parent model: ./plsnt_lgr_parent
 5 layer(s), 70 row(s), 80 column(s)
 delr: [40.00...40.00] meters
 delc: [40.00...40.00] meters
 CRS: EPSG:3070
 length units: meters
 xll: 554200.0; yll: 389000.0; rotation: 0.0
 Bounds: (554200.0, 557400.0, 389000.0, 391800.0)
 Packages: dis ic npf sto rcha_0 oc sfr_0 lak_0 obs_0 wel_0 obs_1
 13 period(s):
  per start_datetime end_datetime  perlen  steady  nstp
    0     2012-01-01   2012-01-01     1.0    True     1
    1     2012-01-01   2012-02-01    31.0   False     1
    2     2012-02-01   2012-03-01    29.0   False     1
    ...
   12     2012-12-01   2013-01-01    31.0   False     1}
</pre></div></div>
</div>
</section>
</section>
<section id="Plot-the-inset-and-parent-model-grids-with-Lake-Package-connections-by-layer">
<h2>Plot the inset and parent model grids with Lake Package connections by layer<a class="headerlink" href="#Plot-the-inset-and-parent-model-grids-with-Lake-Package-connections-by-layer" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">inset</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">inset</span><span class="p">[</span><span class="s1">&#39;plsnt_lgr_inset&#39;</span><span class="p">]</span>

<span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">extent</span>
<span class="n">layer</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">parent_mv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span>
<span class="n">inset_mv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">inset</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span>

<span class="n">vconn</span> <span class="o">=</span> <span class="n">inset</span><span class="o">.</span><span class="n">lak</span><span class="o">.</span><span class="n">connectiondata</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="n">inset</span><span class="o">.</span><span class="n">lak</span><span class="o">.</span><span class="n">connectiondata</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;claktype&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;vertical&#39;</span><span class="p">]</span>
<span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">cellids_to_kij</span><span class="p">(</span><span class="n">vconn</span><span class="p">[</span><span class="s1">&#39;cellid&#39;</span><span class="p">])</span>
<span class="n">lakeconnections</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">inset</span><span class="o">.</span><span class="n">nrow</span><span class="p">,</span> <span class="n">inset</span><span class="o">.</span><span class="n">ncol</span><span class="p">))</span>
<span class="n">lakeconnections</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">lakeconnections</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">lakeconnections</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">lakeconnections</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">qmi</span> <span class="o">=</span> <span class="n">inset_mv</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">lakeconnections</span><span class="p">)</span>

<span class="c1">#inset_mv.plot_bc(&#39;LAK&#39;, color=&#39;navy&#39;)</span>
<span class="c1">#parent_mv.plot_bc(&#39;WEL_0&#39;, color=&#39;red&#39;)</span>

<span class="n">lcp</span> <span class="o">=</span> <span class="n">parent_mv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">lci</span> <span class="o">=</span> <span class="n">inset_mv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">qmi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.colorbar.Colorbar at 0x7fb3526b5340&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Pleasant_lake_lgr_example_24_1.png" src="../_images/notebooks_Pleasant_lake_lgr_example_24_1.png" />
</div>
</div>
<section id="write-the-MODFLOW-input-files">
<h3>write the MODFLOW input files<a class="headerlink" href="#write-the-MODFLOW-input-files" title="Permalink to this headline">¶</a></h3>
<p>(just like you would for a Flopy model)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">write_input</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
writing simulation...
  writing simulation name file...
  writing simulation tdis package...
  writing ims package ims_-1...
  writing mvr package pleasant_lgr.mvr...
  writing package pleasant_lgr.gwfgwf...
  writing model plsnt_lgr_parent...
    writing model name file...
    writing package dis...
    writing package ic...
    writing package npf...
    writing package sto...
    writing package rcha_0...
    writing package oc...
    writing package chd_0...
INFORMATION: maxbound in (&#39;gwf6&#39;, &#39;chd&#39;, &#39;dimensions&#39;) changed to 240 based on size of stress_period_data
    writing package obs_0...
    writing package sfr_0...
    writing package wel_0...
INFORMATION: maxbound in (&#39;gwf6&#39;, &#39;wel&#39;, &#39;dimensions&#39;) changed to 2 based on size of stress_period_data
    writing package obs_1...
  writing model plsnt_lgr_inset...
    writing model name file...
    writing package dis...
    writing package ic...
    writing package npf...
    writing package sto...
    writing package rcha_0...
    writing package oc...
    writing package sfr_0...
    writing package lak_0...
    writing package obs_0...
    writing package wel_0...
INFORMATION: maxbound in (&#39;gwf6&#39;, &#39;wel&#39;, &#39;dimensions&#39;) changed to 2 based on size of stress_period_data
    writing package obs_1...
SFRmaker v. 0.8.0.post24+g7e66d67

Running Flopy v. 3.3.5 diagnostics...
passed.

Checking for continuity in segment and reach numbering...
passed.

Checking for increasing segment numbers in downstream direction...
passed.

Checking for circular routing...
passed.

Checking reach connections for proximity...
2 segments with non-adjacent reaches found.
At segments:
1 2

2 segments with non-adjacent reaches found.
At segments:
1 2


Checking for model cells with multiple non-zero SFR conductances...
passed.

Checking for streambed tops of less than -10...
isfropt setting of 1,2 or 3 requires strtop information!


Checking for streambed tops of greater than 15000...
isfropt setting of 1,2 or 3 requires strtop information!


Checking segment_data for downstream rises in streambed elevation...
Segment elevup and elevdn not specified for nstrm=-13 and isfropt=1
passed.

Checking reach_data for downstream rises in streambed elevation...
3 reaches encountered with strtop &lt; strtop of downstream reach.
Elevation rises:
k i j iseg ireach strtop strtopdn d_strtop reachID diff
4 20 16 2 1 290.3638610839844 294.76507568359375 4.401214599609375 5 -4.401214599609375
4 20 17 2 2 290.3638610839844 293.5867614746094 3.222900390625 6 -3.222900390625
4 21 17 2 3 290.3638610839844 292.6883850097656 2.32452392578125 7 -2.32452392578125


Checking reach_data for inconsistencies between streambed elevations and the model grid...
passed.

Checking segment_data for inconsistencies between segment end elevations and the model grid...
Segment elevup and elevdn not specified for nstrm=-13 and isfropt=1
passed.

Checking for streambed slopes of less than 0.0001...
passed.

Checking for streambed slopes of greater than 1.0...
passed.

wrote plsnt_lgr_parent_SFR.chk
wrote plsnt_lgr_parent.sfr.obs
converting reach and segment data to package data...
wrote ./external/plsnt_lgr_parent_packagedata.dat
wrote ./plsnt_lgr_parent.sfr
</pre></div></div>
</div>
</section>
<section id="Run-the-model">
<h3>Run the model<a class="headerlink" href="#Run-the-model" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FloPy is using the following executable to run the model: /home/runner/.local/bin/mf6
                                   MODFLOW 6
                U.S. GEOLOGICAL SURVEY MODULAR HYDROLOGIC MODEL
                            VERSION 6.2.0 10/22/2020

   MODFLOW 6 compiled Oct 26 2020 11:03:14 with IFORT compiler (ver. 18.0.3)

This software has been approved for release by the U.S. Geological
Survey (USGS). Although the software has been subjected to rigorous
review, the USGS reserves the right to update the software as needed
pursuant to further analysis and review. No warranty, expressed or
implied, is made by the USGS or the U.S. Government as to the
functionality of the software and related material nor shall the
fact of release constitute any such warranty. Furthermore, the
software is released on condition that neither the USGS nor the U.S.
Government shall be held liable for any damages resulting from its
authorized or unauthorized use. Also refer to the USGS Water
Resources Software User Rights Notice for complete use, copyright,
and distribution information.


 Run start date and time (yyyy/mm/dd hh:mm:ss): 2021/11/11  2:44:36

 Writing simulation list file: mfsim.lst
 Using Simulation name file: mfsim.nam

    Solving:  Stress period:     1    Time step:     1
    Solving:  Stress period:     2    Time step:     1
    Solving:  Stress period:     3    Time step:     1
    Solving:  Stress period:     4    Time step:     1
    Solving:  Stress period:     5    Time step:     1
    Solving:  Stress period:     6    Time step:     1
    Solving:  Stress period:     7    Time step:     1
    Solving:  Stress period:     8    Time step:     1
    Solving:  Stress period:     9    Time step:     1
    Solving:  Stress period:    10    Time step:     1
    Solving:  Stress period:    11    Time step:     1
    Solving:  Stress period:    12    Time step:     1
    Solving:  Stress period:    13    Time step:     1

 Run end date and time (yyyy/mm/dd hh:mm:ss): 2021/11/11  2:44:45
 Elapsed run time:  8.976 Seconds

 Normal termination of simulation.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(True, [])
</pre></div></div>
</div>
</section>
<section id="Plot-the-head-results">
<h3>Plot the head results<a class="headerlink" href="#Plot-the-head-results" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tmr_parent_headsobj</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">HeadFile</span><span class="p">(</span><span class="s1">&#39;../data/pleasant/pleasant.hds&#39;</span><span class="p">)</span>
<span class="n">lgr_parent_headsobj</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">HeadFile</span><span class="p">(</span><span class="s1">&#39;plsnt_lgr_parent.hds&#39;</span><span class="p">)</span>
<span class="n">lgr_inset_headsobj</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">HeadFile</span><span class="p">(</span><span class="s1">&#39;plsnt_lgr_inset.hds&#39;</span><span class="p">)</span>

<span class="n">tmr_parent_hds</span> <span class="o">=</span> <span class="n">tmr_parent_headsobj</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">kstpkper</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">lgr_parent_hds</span> <span class="o">=</span> <span class="n">lgr_parent_headsobj</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">kstpkper</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">lgr_inset_hds</span> <span class="o">=</span> <span class="n">lgr_inset_headsobj</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">kstpkper</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">lgr_parent_hds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">lgr_parent_hds</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">lgr_parent_hds</span> <span class="o">==</span> <span class="mf">1e30</span><span class="p">)</span>
<span class="n">lgr_inset_hds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">lgr_inset_hds</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">lgr_inset_hds</span> <span class="o">==</span> <span class="mf">1e30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">layer</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">parent_mv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span>
<span class="n">inset_mv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">inset</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">)</span>

<span class="n">pctr</span> <span class="o">=</span> <span class="n">parent_mv</span><span class="o">.</span><span class="n">contour_array</span><span class="p">(</span><span class="n">lgr_parent_hds</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">290</span><span class="p">,</span> <span class="mi">315</span><span class="p">))</span>
<span class="n">ictr</span> <span class="o">=</span> <span class="n">inset_mv</span><span class="o">.</span><span class="n">contour_array</span><span class="p">(</span><span class="n">lgr_inset_hds</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">290</span><span class="p">,</span> <span class="mi">315</span><span class="p">))</span>
<span class="c1">#qmp = parent_mv.plot_array(lgr_parent_hds)</span>
<span class="c1">#qmi = inset_mv.plot_array(lgr_inset_hds)</span>

<span class="n">lcp</span> <span class="o">=</span> <span class="n">parent_mv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">lci</span> <span class="o">=</span> <span class="n">inset_mv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#plt.colorbar(qmp)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Pleasant_lake_lgr_example_31_0.png" src="../_images/notebooks_Pleasant_lake_lgr_example_31_0.png" />
</div>
</div>
</section>
<section id="Use-Modflow-export-to-export-the-modflow-input-to-PDFs,-rasters-and-shapefiles">
<h3>Use <a class="reference external" href="https://github.com/aleaf/modflow-export">Modflow-export</a> to export the modflow input to PDFs, rasters and shapefiles<a class="headerlink" href="#Use-Modflow-export-to-export-the-modflow-input-to-PDFs,-rasters-and-shapefiles" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">m</span><span class="p">,</span> <span class="n">inset</span><span class="p">:</span>
    <span class="n">mfexport</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">modelgrid</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;postproc/</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
creating postproc/plsnt_lgr_parent/pdfs...
creating postproc/plsnt_lgr_parent/shps...
creating postproc/plsnt_lgr_parent/rasters...

dis package...
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/thickness_lay4.tif
top:
wrote postproc/plsnt_lgr_parent/rasters/top.tif
botm:
wrote postproc/plsnt_lgr_parent/rasters/botm_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/botm_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/botm_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/botm_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/botm_lay4.tif
idomain:
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/idomain_lay4.tif

ic package...
strt:
wrote postproc/plsnt_lgr_parent/rasters/strt_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/strt_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/strt_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/strt_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/strt_lay4.tif

npf package...
icelltype:
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/icelltype_lay4.tif
k:
wrote postproc/plsnt_lgr_parent/rasters/k_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/k_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/k_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/k_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/k_lay4.tif
k33:
wrote postproc/plsnt_lgr_parent/rasters/k33_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/k33_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/k33_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/k33_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/k33_lay4.tif

sto package...
iconvert:
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/iconvert_lay4.tif
ss:
wrote postproc/plsnt_lgr_parent/rasters/ss_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/ss_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/ss_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/ss_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/ss_lay4.tif
sy:
wrote postproc/plsnt_lgr_parent/rasters/sy_lay0.tif
wrote postproc/plsnt_lgr_parent/rasters/sy_lay1.tif
wrote postproc/plsnt_lgr_parent/rasters/sy_lay2.tif
wrote postproc/plsnt_lgr_parent/rasters/sy_lay3.tif
wrote postproc/plsnt_lgr_parent/rasters/sy_lay4.tif

rcha_0 package...
irch:
wrote postproc/plsnt_lgr_parent/rasters/irch_per0.tif
wrote postproc/plsnt_lgr_parent/rasters/irch_per1.tif
recharge:
wrote postproc/plsnt_lgr_parent/rasters/recharge_per0.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per1.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per2.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per3.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per4.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per5.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per6.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per7.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per8.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per9.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per10.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per11.tif
wrote postproc/plsnt_lgr_parent/rasters/recharge_per12.tif

chd_0 package...
writing postproc/plsnt_lgr_parent/shps/chd0_stress_period_data.shp... Done
head:
boundname:
Warning, variable: boundname
Export of non-period data from transientlists not implemented!

obs_0 package...
skipped, not implemented yet

sfr_0 package...
writing postproc/plsnt_lgr_parent/shps/plsnt_lgr_parent.sfr.shp... Done

wel_0 package...
writing postproc/plsnt_lgr_parent/shps/wel0_stress_period_data.shp... Done
q:
boundname:
Warning, variable: boundname
Export of non-period data from transientlists not implemented!

obs_1 package...
writing postproc/plsnt_lgr_parent/shps/obs1_stress_period_data.shp... Done
creating postproc/plsnt_lgr_inset/pdfs...
creating postproc/plsnt_lgr_inset/shps...
creating postproc/plsnt_lgr_inset/rasters...

dis package...
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/thickness_lay4.tif
top:
wrote postproc/plsnt_lgr_inset/rasters/top.tif
botm:
wrote postproc/plsnt_lgr_inset/rasters/botm_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/botm_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/botm_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/botm_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/botm_lay4.tif
idomain:
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/idomain_lay4.tif

ic package...
strt:
wrote postproc/plsnt_lgr_inset/rasters/strt_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/strt_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/strt_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/strt_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/strt_lay4.tif

npf package...
icelltype:
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/icelltype_lay4.tif
k:
wrote postproc/plsnt_lgr_inset/rasters/k_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/k_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/k_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/k_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/k_lay4.tif
k33:
wrote postproc/plsnt_lgr_inset/rasters/k33_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/k33_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/k33_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/k33_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/k33_lay4.tif

sto package...
iconvert:
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/iconvert_lay4.tif
ss:
wrote postproc/plsnt_lgr_inset/rasters/ss_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/ss_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/ss_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/ss_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/ss_lay4.tif
sy:
wrote postproc/plsnt_lgr_inset/rasters/sy_lay0.tif
wrote postproc/plsnt_lgr_inset/rasters/sy_lay1.tif
wrote postproc/plsnt_lgr_inset/rasters/sy_lay2.tif
wrote postproc/plsnt_lgr_inset/rasters/sy_lay3.tif
wrote postproc/plsnt_lgr_inset/rasters/sy_lay4.tif

rcha_0 package...
irch:
wrote postproc/plsnt_lgr_inset/rasters/irch_per0.tif
wrote postproc/plsnt_lgr_inset/rasters/irch_per1.tif
recharge:
wrote postproc/plsnt_lgr_inset/rasters/recharge_per0.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per1.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per2.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per3.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per4.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per5.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per6.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per7.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per8.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per9.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per10.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per11.tif
wrote postproc/plsnt_lgr_inset/rasters/recharge_per12.tif

sfr_0 package...
writing postproc/plsnt_lgr_inset/shps/plsnt_lgr_inset.sfr.shp... Done

lak_0 package...
skipped, not implemented yet

obs_0 package...
skipped, not implemented yet

wel_0 package...
writing postproc/plsnt_lgr_inset/shps/wel0_stress_period_data.shp... Done
q:
boundname:
Warning, variable: boundname
Export of non-period data from transientlists not implemented!

obs_1 package...
writing postproc/plsnt_lgr_inset/shps/obs1_stress_period_data.shp... Done
</pre></div></div>
</div>
</section>
</section>
<section id="Modflow-export-can-also-create-a-summary-table-of-the-model-inputs">
<h2>Modflow-export can also create a summary table of the model inputs<a class="headerlink" href="#Modflow-export-can-also-create-a-summary-table-of-the-model-inputs" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">m</span><span class="p">,</span> <span class="n">inset</span><span class="p">:</span>
    <span class="n">mfexport</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;postproc/</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
summarizing plsnt_lgr_parent input...
summarizing plsnt_lgr_inset input...
skipped, not implemented yet
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../config-file-gallery.html" class="btn btn-neutral float-right" title="Configuration File Gallery" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, Modflow-setup developers |.
      <span class="lastupdated">Last updated on Nov 11, 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>