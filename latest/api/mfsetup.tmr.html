<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mfsetup.tmr module &mdash; modflow-setup 0.post292+g7d3ae12 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configuration defaults" href="../config-file-defaults.html" />
    <link rel="prev" title="mfsetup.tdis module" href="mfsetup.tdis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> modflow-setup
          </a>
              <div class="version">
                0.post292+g7d3ae12
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../philosophy.html">     Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html"> Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html"> Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config-file-gallery.html"> Configuration File Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../structure.html"> Basic program structure and usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config-file.html"> The configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html"> Concepts and methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html"> Input instructions by package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html"> Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html"> Code reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#model-classes">Model classes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#supporting-modules">Supporting modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mfsetup.discretization.html">mfsetup.discretization module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mfsetup.fileio.html">mfsetup.fileio module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mfsetup.grid.html">mfsetup.grid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mfsetup.tdis.html">mfsetup.tdis module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">mfsetup.tmr module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../config-file-defaults.html"> Configuration file defaults</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html"> Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html"> Contributing to modflow-setup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html"> References cited</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">modflow-setup</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Code Reference</a> &raquo;</li>
      <li>mfsetup.tmr module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/mfsetup.tmr.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-mfsetup.tmr">
<span id="mfsetup-tmr-module"></span><h1>mfsetup.tmr module<a class="headerlink" href="#module-mfsetup.tmr" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="mfsetup.tmr.TmrNew">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfsetup.tmr.</span></span><span class="sig-name descname"><span class="pre">TmrNew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_head_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_cell_budget_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_parent_period_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_start_date_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">define_connections_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max_active_extent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfsetup/tmr.html#TmrNew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfsetup.tmr.TmrNew" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for general telescopic mesh refinement of a MODFLOW model. Head or
flux fields from parent model are interpolated to boundary cells of
inset model, which may be in any configuration (jagged, rotated, etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>parent_model</strong><span class="classifier">flopy model instance instance of parent model</span></dt><dd><p>Must have a valid, attached ModelGrid (modelgrid) attribute.</p>
</dd>
<dt><strong>inset_model</strong><span class="classifier">flopy model instance instance of inset model</span></dt><dd><p>Must have a valid, attached ModelGrid (modelgrid) attribute.</p>
</dd>
<dt><strong>parent_head_file</strong><span class="classifier">filepath</span></dt><dd><p>MODFLOW binary head output</p>
</dd>
<dt><strong>parent_cell_budget_file</strong><span class="classifier">filepath</span></dt><dd><p>MODFLOW binary cell budget output</p>
</dd>
<dt><strong>define_connections</strong><span class="classifier">str, {‘max_active_extent’, ‘by_layer’}</span></dt><dd><p>Method for defining perimeter cells where the TMR boundary
condition will be applied. If ‘max_active_extent’, the
maximum footprint of the active area (including all cell
locations with at least one layer that is active) will be used.
If ‘by_layer’, the perimeter of the active area in each layer will be used
(excluding any interior clusters of active cells). The ‘by_layer’
option is potentially problematic if some layers have substantial
areas of pinched-out (idomain != 1) cells, which may result
in perimeter boundary condition cells getting placed too close
to the area of interest. By default, ‘max_active_extent’.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mfsetup.tmr.TmrNew.get_inset_boundary_cells">
<span class="sig-name descname"><span class="pre">get_inset_boundary_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfsetup/tmr.html#TmrNew.get_inset_boundary_cells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfsetup.tmr.TmrNew.get_inset_boundary_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dataframe of connection information for
horizontal boundary cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>by_layer</strong><span class="classifier">bool</span></dt><dd><p>Controls how boundary cells will be defined. If True,
the perimeter of the active area in each layer will be used
(excluding any interior clusters of active cells). If
False, the maximum footprint of the active area
(including all cell locations with at least one layer that
is active).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfsetup.tmr.TmrNew.get_inset_boundary_values">
<span class="sig-name descname"><span class="pre">get_inset_boundary_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">for_external_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfsetup/tmr.html#TmrNew.get_inset_boundary_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfsetup.tmr.TmrNew.get_inset_boundary_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mfsetup.tmr.TmrNew.idomain">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">idomain</span></span><a class="headerlink" href="#mfsetup.tmr.TmrNew.idomain" title="Permalink to this definition">¶</a></dt>
<dd><p>Active area of the inset model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mfsetup.tmr.TmrNew.inset_boundary_cells">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inset_boundary_cells</span></span><a class="headerlink" href="#mfsetup.tmr.TmrNew.inset_boundary_cells" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mfsetup.tmr.TmrNew.inset_parent_period_mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inset_parent_period_mapping</span></span><a class="headerlink" href="#mfsetup.tmr.TmrNew.inset_parent_period_mapping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mfsetup.tmr.TmrNew.interp_weights">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp_weights</span></span><a class="headerlink" href="#mfsetup.tmr.TmrNew.interp_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given parent, only calculate interpolation weights
once to speed up re-gridding of arrays to pfl_nwt.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfsetup.tmr.TmrNew.interpolate_values">
<span class="sig-name descname"><span class="pre">interpolate_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfsetup/tmr.html#TmrNew.interpolate_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfsetup.tmr.TmrNew.interpolate_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate values in source array onto
the destination model grid, using modelgrid instances
attached to the source and destination models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>source_array</strong><span class="classifier">ndarray</span></dt><dd><p>Values from source model to be interpolated to destination grid.
3D numpy array of same shape as the source model.</p>
</dd>
<dt><strong>method</strong><span class="classifier">str (‘linear’, ‘nearest’)</span></dt><dd><p>Interpolation method.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>interpolated</strong><span class="classifier">ndarray</span></dt><dd><p>3D array of interpolated values at the inset model grid locations.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mfsetup.tmr.TmrNew.parent_xyzcellcenters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parent_xyzcellcenters</span></span><a class="headerlink" href="#mfsetup.tmr.TmrNew.parent_xyzcellcenters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get x, y, z locations of parent cells in a buffered area
(defined by the _source_grid_mask property) around the
inset model.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfsetup.tmr.distribute_parent_fluxes_to_inset">
<span class="sig-prename descclassname"><span class="pre">mfsetup.tmr.</span></span><span class="sig-name descname"><span class="pre">distribute_parent_fluxes_to_inset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q_parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">botm_parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">botm_inset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kh_inset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_table_parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiramp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfsetup/tmr.html#distribute_parent_fluxes_to_inset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfsetup.tmr.distribute_parent_fluxes_to_inset" title="Permalink to this definition">¶</a></dt>
<dd><p>Redistributes a vertical column of parent model fluxes at a single
location i, j in the parent model, to the corresponding layers in the
pfl_nwt model, based on pfl_nwt model layer transmissivities, accounting for the
position of the water table in the parent model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Q_parent</strong><span class="classifier">1D array,</span></dt><dd><p>Vertical column of horizontal fluxes through a cell face
at a location at a location i, j in the parent model.
(Length is n parent layers)</p>
</dd>
<dt><strong>botm_parent</strong><span class="classifier">1D array</span></dt><dd><p>Layer bottom elevations at location i, j in parent model.
(Length is n parent layers)</p>
</dd>
<dt><strong>top_parent</strong><span class="classifier">float</span></dt><dd><p>Top elevation of parent model at location i, j</p>
</dd>
<dt><strong>botm_inset</strong><span class="classifier">1D array</span></dt><dd><p>Mean elevation of pfl_nwt cells along the boundary face, by layer.
(Length is n pfl_nwt layers)</p>
</dd>
<dt><strong>kh_inset</strong><span class="classifier">1D array</span></dt><dd><p>Mean hydraulic conductivity of pfl_nwt cells along the boundary face, by layer.
(Length is n pfl_nwt layers)</p>
</dd>
<dt><strong>water_table_parent</strong><span class="classifier">float</span></dt><dd><p>Water table elevation in parent model.</p>
</dd>
<dt><strong>phiramp</strong><span class="classifier">float</span></dt><dd><p>Fluxes in layers with saturated thickness fraction (sat thickness/total cell thickness)
below this threshold will be assigned to the next underlying layer with a
saturated thickness fraction above this threshold. (default 0.01)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Q_inset</strong><span class="classifier">1D array</span></dt><dd><p>Vertical column of horizontal fluxes through each layer of the pfl_nwt
model, for the group of pfl_nwt model cells corresponding to parent
location i, j (represents the sum of horizontal flux through the
boundary face of the pfl_nwt model cells in each layer).
(Length is n pfl_nwt layers).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mfsetup.tdis.html" class="btn btn-neutral float-left" title="mfsetup.tdis module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../config-file-defaults.html" class="btn btn-neutral float-right" title="Configuration defaults" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Modflow-setup developers |.
      <span class="lastupdated">Last updated on Mar 24, 2022.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>